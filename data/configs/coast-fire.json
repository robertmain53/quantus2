{
  "version": "1.0.0",
  "metadata": {
    "title": "Coast FIRE Calculator (Advanced)",
    "description": "Estimate the lump sum you must already have invested so future compound returns can grow it to your retirement target without further contributions. Includes real-return adjustment, target portfolio calculation from spending or withdrawal rate, and an alternate annual-savings projection."
  },
  "logic": {
    "type": "advanced",
    "defaultMethod": "coast_fire",
    "methods": {
      "coast_fire": {
        "label": "Coast FIRE (present lump sum to stop contributing)",
        "description": "Calculates the amount you need today so that, at a projected real return, your holdings will grow to the target retirement portfolio by your chosen retirement age without additional contributions.",
        "variables": {
          "n_years": {
            "expression": "target_fire_age - current_age",
            "dependencies": [
              "target_fire_age",
              "current_age"
            ],
            "label": "Years until target",
            "unit": "years",
            "format": "integer",
            "display": true
          },
          "real_return": {
            "expression": "(1 + nominal_return_pct/100) / (1 + inflation_pct/100) - 1",
            "dependencies": [
              "nominal_return_pct",
              "inflation_pct"
            ],
            "label": "Estimated real annual return",
            "unit": "%",
            "format": "percent",
            "display": true
          },
          "target_portfolio": {
            "expression": "target_yearly_spending / (withdrawal_rate_pct/100)",
            "dependencies": [
              "target_yearly_spending",
              "withdrawal_rate_pct"
            ],
            "label": "Target portfolio at retirement",
            "unit": "currency",
            "format": "currency",
            "display": true
          },
          "required_coast_amount": {
            "expression": "target_portfolio / pow(1 + real_return, n_years)",
            "dependencies": [
              "target_portfolio",
              "real_return",
              "n_years"
            ],
            "label": "Lump sum required today to coast",
            "unit": "currency",
            "format": "currency",
            "display": true
          },
          "future_value_current_savings": {
            "expression": "current_savings * pow(1 + real_return, n_years)",
            "dependencies": [
              "current_savings",
              "real_return",
              "n_years"
            ],
            "label": "Future value of current savings at target age",
            "unit": "currency",
            "format": "currency",
            "display": true
          },
          "additional_required_today": {
            "expression": "max(required_coast_amount - future_value_current_savings, 0)",
            "dependencies": [
              "required_coast_amount",
              "future_value_current_savings"
            ],
            "label": "Additional lump sum needed today (if positive)",
            "unit": "currency",
            "format": "currency",
            "display": true
          },
          "annual_contribution_to_hit_target": {
            "expression": "real_return == 0 ? (target_portfolio - current_savings) / n_years : (target_portfolio - current_savings * pow(1 + real_return, n_years)) * real_return / (pow(1 + real_return, n_years) - 1)",
            "dependencies": [
              "target_portfolio",
              "current_savings",
              "real_return",
              "n_years"
            ],
            "label": "Annual contribution required to reach target by target age",
            "unit": "currency/year",
            "format": "currency",
            "display": true
          }
        },
        "outputs": [
          {
            "id": "required_coast_amount",
            "label": "Coast lump sum required today",
            "variable": "required_coast_amount",
            "unit": "currency",
            "format": "currency"
          },
          {
            "id": "future_value_current_savings",
            "label": "Future value of current savings",
            "variable": "future_value_current_savings",
            "unit": "currency",
            "format": "currency"
          },
          {
            "id": "additional_required_today",
            "label": "Additional lump sum needed today",
            "variable": "additional_required_today",
            "unit": "currency",
            "format": "currency"
          },
          {
            "id": "annual_contribution_to_hit_target",
            "label": "Annual contribution to hit target",
            "variable": "annual_contribution_to_hit_target",
            "unit": "currency/year",
            "format": "currency"
          },
          {
            "id": "target_portfolio",
            "label": "Target portfolio at retirement",
            "variable": "target_portfolio",
            "unit": "currency",
            "format": "currency"
          },
          {
            "id": "real_return",
            "label": "Estimated real annual return",
            "variable": "real_return",
            "unit": "%",
            "format": "percent"
          },
          {
            "id": "n_years",
            "label": "Years until target",
            "variable": "n_years",
            "unit": "years",
            "format": "integer"
          }
        ]
      },
      "compare_with_savings_plan": {
        "label": "Compare: continue saving until target",
        "description": "Shows how much continued contributions change the annual saving needed and how current savings grow toward the same target. Uses the same real-return calculation and target portfolio as the Coast method.",
        "variables": {
          "n_years": {
            "expression": "target_fire_age - current_age",
            "dependencies": [
              "target_fire_age",
              "current_age"
            ],
            "label": "Years until target",
            "unit": "years",
            "format": "integer",
            "display": true
          },
          "real_return": {
            "expression": "(1 + nominal_return_pct/100) / (1 + inflation_pct/100) - 1",
            "dependencies": [
              "nominal_return_pct",
              "inflation_pct"
            ],
            "label": "Estimated real annual return",
            "unit": "%",
            "format": "percent",
            "display": true
          },
          "target_portfolio": {
            "expression": "target_yearly_spending / (withdrawal_rate_pct/100)",
            "dependencies": [
              "target_yearly_spending",
              "withdrawal_rate_pct"
            ],
            "label": "Target portfolio at retirement",
            "unit": "currency",
            "format": "currency",
            "display": true
          },
          "fv_with_contributions": {
            "expression": "current_savings * pow(1 + real_return, n_years) + annual_contribution * ( (pow(1 + real_return, n_years) - 1) / real_return )",
            "dependencies": [
              "current_savings",
              "annual_contribution",
              "real_return",
              "n_years"
            ],
            "label": "Future value with continued contributions",
            "unit": "currency",
            "format": "currency",
            "display": true
          },
          "gap_after_contributions": {
            "expression": "max(target_portfolio - fv_with_contributions, 0)",
            "dependencies": [
              "target_portfolio",
              "fv_with_contributions"
            ],
            "label": "Gap after continued contributions",
            "unit": "currency",
            "format": "currency",
            "display": true
          }
        },
        "outputs": [
          {
            "id": "fv_with_contributions",
            "label": "Future value with continued contributions",
            "variable": "fv_with_contributions",
            "unit": "currency",
            "format": "currency"
          },
          {
            "id": "gap_after_contributions",
            "label": "Gap after continued contributions",
            "variable": "gap_after_contributions",
            "unit": "currency",
            "format": "currency"
          }
        ]
      }
    }
  },
  "form": {
    "fields": [
      {
        "id": "current_age",
        "label": "Current age",
        "type": "integer",
        "default": 35,
        "min": 18,
        "max": 100,
        "step": 1
      },
      {
        "id": "target_fire_age",
        "label": "Target FIRE age",
        "type": "integer",
        "default": 60,
        "min": 25,
        "max": 100,
        "step": 1
      },
      {
        "id": "current_savings",
        "label": "Current invested savings (taxable + tax-advantaged)",
        "type": "number",
        "default": 50000,
        "min": 0,
        "step": 100
      },
      {
        "id": "annual_contribution",
        "label": "Annual contribution if you continue saving",
        "type": "number",
        "default": 10000,
        "min": 0,
        "step": 100
      },
      {
        "id": "nominal_return_pct",
        "label": "Expected nominal annual return (pre-inflation)",
        "type": "number",
        "default": 7,
        "min": -10,
        "max": 30,
        "step": 0.1
      },
      {
        "id": "inflation_pct",
        "label": "Expected annual inflation",
        "type": "number",
        "default": 2.5,
        "min": -5,
        "max": 15,
        "step": 0.1
      },
      {
        "id": "target_yearly_spending",
        "label": "Estimated annual spending in retirement (today's dollars)",
        "type": "number",
        "default": 40000,
        "min": 0,
        "step": 100
      },
      {
        "id": "withdrawal_rate_pct",
        "label": "Assumed safe withdrawal rate (percent)",
        "type": "number",
        "default": 4,
        "min": 0.1,
        "max": 10,
        "step": 0.1
      }
    ]
  },
  "page_content": {
    "introduction": [
      "This Coast FIRE calculator estimates the present lump sum (the 'coast' amount) you would need so that, at an estimated real rate of return, your investments grow to a retirement portfolio that funds your target spending without further contributions.",
      "It also compares outcomes if you continue contributing annually and shows the additional lump sum or annual contribution required to reach the same target. Use conservative inputs and review assumptions; results are estimates, not guarantees."
    ],
    "methodology": [
      "Calculations use a real-return approach where nominal expected return is adjusted by expected inflation to produce an estimated real annual return. This avoids mixing nominal growth assumptions with inflation-adjusted spending targets.",
      "Target portfolio is computed by dividing desired annual retirement spending by the chosen withdrawal rate. The 'coast' amount is the present value of that target portfolio discounted by the real return for the number of years until target age.",
      "This tool follows best-practice guidance for transparency and reproducibility. It documents inputs, uses explicit formulas, and includes caveats about model limitations. For computational integrity and data handling, follow applicable standards such as NIST guidance for data integrity and ISO/IEEE standards for software quality. This calculator does not provide legal, tax, or investment advice."
    ],
    "how_is_calculated": [
      "1) Years until target: n = target_fire_age - current_age.",
      "2) Real return: r = (1 + nominal_return) / (1 + inflation) - 1.",
      "3) Target portfolio: T = target_yearly_spending / withdrawal_rate.",
      "4) Required coast amount: PV = T / (1 + r)^n.",
      "5) Future value of current savings: FV = current_savings * (1 + r)^n.",
      "6) Additional lump sum needed today = max(PV - FV, 0).",
      "7) Annual contribution required to reach T by target age is solved with the standard future-value annuity formula; a zero-real-return fallback uses a linear division."
    ],
    "examples": [
      "Example 1: Age 35, want to retire at 60, $40,000/year spending, 4% withdrawal rate, 7% nominal return, 2.5% inflation. The tool computes the coast lump sum and shows whether current savings will grow to meet it.",
      "Example 2: If current savings are below the coast amount, the tool shows the additional lump sum needed today or the annual contributions required to reach the target by the retirement age."
    ],
    "faqs": [
      {
        "question": "What does 'Coast FIRE' mean?",
        "answer": "Coast FIRE means you have accumulated enough capital such that, if you stop adding new contributions, compound growth alone will make the portfolio reach your retirement target by your chosen retirement age."
      },
      {
        "question": "Should I use nominal or real returns?",
        "answer": "Use nominal return for market expectations and include an explicit inflation input. The calculator converts nominal to real return so target spending (in today's dollars) is compared to inflation-adjusted growth."
      },
      {
        "question": "How accurate are the results?",
        "answer": "Results are estimates based on user inputs and a deterministic compounding model. They do not account for sequence-of-returns risk, taxes, fees, stochastic volatility, or changes in spending. Use them for planning and sensitivity analysis, and consult a licensed financial professional for personalized advice."
      },
      {
        "question": "Why is a standards citation included?",
        "answer": "We reference standards (NIST, ISO, IEEE, OSHA) to highlight practices for data integrity, software quality, and safety in tooling. This calculator documents assumptions and limitations to improve trust and reproducibility; it is not a regulated financial product."
      }
    ],
    "citations": [
      {
        "label": "NIST — National Institute of Standards and Technology",
        "url": "https://www.nist.gov/"
      },
      {
        "label": "ISO — International Organization for Standardization",
        "url": "https://www.iso.org/"
      },
      {
        "label": "IEEE Standards Association",
        "url": "https://standards.ieee.org/"
      },
      {
        "label": "OSHA — Occupational Safety and Health Administration",
        "url": "https://www.osha.gov/"
      }
    ],
    "glossary": [
      {
        "term": "Coast FIRE",
        "definition": "A stage where the current invested balance is sufficient such that expected compound returns will grow it to the desired retirement portfolio without additional contributions."
      },
      {
        "term": "Real return",
        "definition": "The nominal return adjusted for inflation: (1 + nominal) / (1 + inflation) - 1."
      },
      {
        "term": "Target portfolio",
        "definition": "The portfolio value required at retirement to support desired spending, computed as annual spending divided by the assumed withdrawal rate."
      },
      {
        "term": "Safe withdrawal rate",
        "definition": "A percentage of the portfolio that can be withdrawn annually (often expressed as 4%) intended to balance longevity risk and sustainable spending; a planning assumption, not a guarantee."
      }
    ]
  }
}