{
  "version": "1.0.0",
  "metadata": {
    "title": "Student Loan — Variable Rate Projection & Weighted Average Calculator",
    "description": "Project payments for variable-rate student loans, compare weighted-average rates across multiple loans, and estimate payment changes after rate adjustments. Includes conservative assumptions, scenario inputs, and clear accuracy notes tied to standards for software and data handling."
  },
  "logic": {
    "type": "advanced",
    "defaultMethod": "single_variable_loan",
    "methods": {
      "single_variable_loan": {
        "label": "Single variable-rate loan (projection)",
        "description": "Calculates current periodic payment for an amortizing variable-rate loan and projects the next adjustment's rate and approximate payment assuming the rate changes at the next adjustment. Uses simple adjustment assumptions; see methodology for limitations.",
        "variables": {
          "current_rate": {
            "expression": "initial_rate_percent / 100",
            "dependencies": [
              "initial_rate_percent"
            ],
            "label": "Current annual rate (decimal)",
            "format": "percent",
            "display": true
          },
          "period_rate": {
            "expression": "current_rate / payments_per_year",
            "dependencies": [
              "current_rate",
              "payments_per_year"
            ],
            "label": "Periodic rate (decimal)",
            "format": "percent",
            "display": true
          },
          "total_payments": {
            "expression": "loan_term_years * payments_per_year",
            "dependencies": [
              "loan_term_years",
              "payments_per_year"
            ],
            "label": "Total number of payments",
            "format": "integer",
            "display": false
          },
          "periodic_payment": {
            "expression": "(principal * period_rate) / (1 - pow(1 + period_rate, -total_payments))",
            "dependencies": [
              "principal",
              "period_rate",
              "total_payments"
            ],
            "label": "Current periodic payment",
            "unit": "currency",
            "format": "currency",
            "display": true
          },
          "annual_payment": {
            "expression": "periodic_payment * payments_per_year",
            "dependencies": [
              "periodic_payment",
              "payments_per_year"
            ],
            "label": "Annual payment (estimate)",
            "unit": "currency",
            "format": "currency",
            "display": true
          },
          "total_paid": {
            "expression": "periodic_payment * total_payments",
            "dependencies": [
              "periodic_payment",
              "total_payments"
            ],
            "label": "Total amount paid (principal + interest)",
            "unit": "currency",
            "format": "currency",
            "display": false
          },
          "total_interest": {
            "expression": "total_paid - principal",
            "dependencies": [
              "total_paid",
              "principal"
            ],
            "label": "Total interest over term (estimate)",
            "unit": "currency",
            "format": "currency",
            "display": true
          },
          "projected_rate_next_dec": {
            "expression": "min(max((index_rate_percent + expected_index_growth_percent + margin_percent) / 100, rate_floor_percent / 100), rate_ceiling_percent / 100)",
            "dependencies": [
              "index_rate_percent",
              "expected_index_growth_percent",
              "margin_percent",
              "rate_floor_percent",
              "rate_ceiling_percent"
            ],
            "label": "Projected next annual rate (decimal, bounded by floor/ceiling)",
            "format": "percent",
            "display": true
          },
          "remaining_payments": {
            "expression": "total_payments - (rate_adjust_period_years * payments_per_year)",
            "dependencies": [
              "total_payments",
              "rate_adjust_period_years",
              "payments_per_year"
            ],
            "label": "Remaining payments at next adjustment (approx.)",
            "format": "integer",
            "display": false
          },
          "payment_after_adjustment": {
            "expression": "(principal * (projected_rate_next_dec / payments_per_year)) / (1 - pow(1 + (projected_rate_next_dec / payments_per_year), -remaining_payments))",
            "dependencies": [
              "principal",
              "projected_rate_next_dec",
              "payments_per_year",
              "remaining_payments"
            ],
            "label": "Approx. periodic payment after next adjustment",
            "unit": "currency",
            "format": "currency",
            "display": true
          }
        },
        "outputs": [
          {
            "id": "periodic_payment",
            "label": "Current periodic payment",
            "variable": "periodic_payment",
            "unit": "currency",
            "format": "currency"
          },
          {
            "id": "annual_payment",
            "label": "Annual payment (estimate)",
            "variable": "annual_payment",
            "unit": "currency",
            "format": "currency"
          },
          {
            "id": "total_interest",
            "label": "Total interest (estimate)",
            "variable": "total_interest",
            "unit": "currency",
            "format": "currency"
          },
          {
            "id": "projected_rate_next_dec",
            "label": "Projected next annual rate (decimal)",
            "variable": "projected_rate_next_dec",
            "format": "percent"
          },
          {
            "id": "payment_after_adjustment",
            "label": "Approx. payment after next adjustment",
            "variable": "payment_after_adjustment",
            "unit": "currency",
            "format": "currency"
          }
        ]
      },
      "weighted_average_loans": {
        "label": "Weighted-average rate for multiple loans",
        "description": "Compute a balance-weighted average annual rate across up to three loans and the equivalent single-loan periodic payment using that weighted rate.",
        "variables": {
          "total_balance": {
            "expression": "loan1_balance + loan2_balance + loan3_balance",
            "dependencies": [
              "loan1_balance",
              "loan2_balance",
              "loan3_balance"
            ],
            "label": "Total combined balance",
            "unit": "currency",
            "format": "currency",
            "display": false
          },
          "weighted_rate_dec": {
            "expression": "((loan1_balance * loan1_rate_percent) + (loan2_balance * loan2_rate_percent) + (loan3_balance * loan3_rate_percent)) / total_balance / 100",
            "dependencies": [
              "loan1_balance",
              "loan1_rate_percent",
              "loan2_balance",
              "loan2_rate_percent",
              "loan3_balance",
              "loan3_rate_percent",
              "total_balance"
            ],
            "label": "Weighted annual rate (decimal)",
            "format": "percent",
            "display": true
          },
          "wa_period_rate": {
            "expression": "weighted_rate_dec / payments_per_year",
            "dependencies": [
              "weighted_rate_dec",
              "payments_per_year"
            ],
            "label": "Weighted periodic rate",
            "format": "percent",
            "display": false
          },
          "wa_total_payments": {
            "expression": "loan_term_years * payments_per_year",
            "dependencies": [
              "loan_term_years",
              "payments_per_year"
            ],
            "label": "Total payments (for weighted calc)",
            "format": "integer",
            "display": false
          },
          "equivalent_periodic_payment": {
            "expression": "(total_balance * wa_period_rate) / (1 - pow(1 + wa_period_rate, -wa_total_payments))",
            "dependencies": [
              "total_balance",
              "wa_period_rate",
              "wa_total_payments"
            ],
            "label": "Equivalent periodic payment (weighted)",
            "unit": "currency",
            "format": "currency",
            "display": true
          }
        },
        "outputs": [
          {
            "id": "weighted_rate_dec",
            "label": "Weighted annual rate (decimal)",
            "variable": "weighted_rate_dec",
            "format": "percent"
          },
          {
            "id": "equivalent_periodic_payment",
            "label": "Equivalent periodic payment",
            "variable": "equivalent_periodic_payment",
            "unit": "currency",
            "format": "currency"
          },
          {
            "id": "total_balance",
            "label": "Total combined balance",
            "variable": "total_balance",
            "unit": "currency",
            "format": "currency"
          }
        ]
      }
    }
  },
  "form": {
    "fields": [
      {
        "id": "principal",
        "label": "Loan principal (total balance)",
        "type": "number",
        "default": 20000,
        "min": 0,
        "step": 1
      },
      {
        "id": "loan_term_years",
        "label": "Loan term (years)",
        "type": "integer",
        "default": 10,
        "min": 1,
        "max": 40,
        "step": 1
      },
      {
        "id": "payments_per_year",
        "label": "Payments per year",
        "type": "integer",
        "default": 12,
        "min": 1,
        "max": 12,
        "step": 1
      },
      {
        "id": "initial_rate_percent",
        "label": "Current annual interest rate (percent, APR)",
        "type": "number",
        "default": 5.0,
        "min": 0,
        "max": 100,
        "step": 0.01
      },
      {
        "id": "index_rate_percent",
        "label": "Index rate (current, percent)",
        "type": "number",
        "default": 2.5,
        "min": 0,
        "max": 100,
        "step": 0.01
      },
      {
        "id": "margin_percent",
        "label": "Lender margin (percent)",
        "type": "number",
        "default": 2.0,
        "min": 0,
        "max": 100,
        "step": 0.01
      },
      {
        "id": "rate_adjust_period_years",
        "label": "Years between rate adjustments",
        "type": "number",
        "default": 1,
        "min": 0.25,
        "max": 10,
        "step": 0.25
      },
      {
        "id": "expected_index_growth_percent",
        "label": "Expected change in index at next adjustment (percent)",
        "type": "number",
        "default": 0.0,
        "min": -50,
        "max": 50,
        "step": 0.01
      },
      {
        "id": "rate_floor_percent",
        "label": "Contractual rate floor (percent)",
        "type": "number",
        "default": 0.0,
        "min": 0,
        "max": 100,
        "step": 0.01
      },
      {
        "id": "rate_ceiling_percent",
        "label": "Contractual rate ceiling (percent)",
        "type": "number",
        "default": 25.0,
        "min": 0,
        "max": 100,
        "step": 0.01
      },
      {
        "id": "loan_profile",
        "label": "Loan profile",
        "type": "select",
        "default": "single",
        "options": [
          {
            "label": "Single loan",
            "value": "single"
          },
          {
            "label": "Multiple loans (up to 3)",
            "value": "multiple"
          }
        ]
      },
      {
        "id": "loan1_balance",
        "label": "Loan 1 balance (used in multiple-loan profile)",
        "type": "number",
        "default": 10000,
        "min": 0,
        "step": 1
      },
      {
        "id": "loan1_rate_percent",
        "label": "Loan 1 rate (percent)",
        "type": "number",
        "default": 4.5,
        "min": 0,
        "max": 100,
        "step": 0.01
      },
      {
        "id": "loan2_balance",
        "label": "Loan 2 balance (used in multiple-loan profile)",
        "type": "number",
        "default": 5000,
        "min": 0,
        "step": 1
      },
      {
        "id": "loan2_rate_percent",
        "label": "Loan 2 rate (percent)",
        "type": "number",
        "default": 6.0,
        "min": 0,
        "max": 100,
        "step": 0.01
      },
      {
        "id": "loan3_balance",
        "label": "Loan 3 balance (used in multiple-loan profile)",
        "type": "number",
        "default": 5000,
        "min": 0,
        "step": 1
      },
      {
        "id": "loan3_rate_percent",
        "label": "Loan 3 rate (percent)",
        "type": "number",
        "default": 5.0,
        "min": 0,
        "max": 100,
        "step": 0.01
      }
    ],
    "sections": [
      {
        "id": "multiple_loans_section",
        "label": "Multiple loans details",
        "show_when": {
          "field": "loan_profile",
          "is": "multiple"
        },
        "fields": [
          {
            "id": "loan1_balance",
            "label": "Loan 1 balance",
            "type": "number",
            "default": 10000,
            "min": 0,
            "step": 1
          },
          {
            "id": "loan1_rate_percent",
            "label": "Loan 1 annual rate (percent)",
            "type": "number",
            "default": 4.5,
            "min": 0,
            "max": 100,
            "step": 0.01
          },
          {
            "id": "loan2_balance",
            "label": "Loan 2 balance",
            "type": "number",
            "default": 5000,
            "min": 0,
            "step": 1
          },
          {
            "id": "loan2_rate_percent",
            "label": "Loan 2 annual rate (percent)",
            "type": "number",
            "default": 6.0,
            "min": 0,
            "max": 100,
            "step": 0.01
          },
          {
            "id": "loan3_balance",
            "label": "Loan 3 balance",
            "type": "number",
            "default": 5000,
            "min": 0,
            "step": 1
          },
          {
            "id": "loan3_rate_percent",
            "label": "Loan 3 annual rate (percent)",
            "type": "number",
            "default": 5.0,
            "min": 0,
            "max": 100,
            "step": 0.01
          }
        ]
      }
    ],
    "result": {
      "outputs": [
        {
          "id": "periodic_payment",
          "label": "Current periodic payment"
        },
        {
          "id": "annual_payment",
          "label": "Annual payment (estimate)"
        },
        {
          "id": "total_interest",
          "label": "Total interest (estimate)"
        },
        {
          "id": "projected_rate_next_dec",
          "label": "Projected next annual rate (decimal)"
        },
        {
          "id": "payment_after_adjustment",
          "label": "Approx. payment after next adjustment"
        },
        {
          "id": "weighted_rate_dec",
          "label": "Weighted annual rate (decimal)"
        },
        {
          "id": "equivalent_periodic_payment",
          "label": "Equivalent periodic payment (weighted)"
        },
        {
          "id": "total_balance",
          "label": "Total combined balance"
        }
      ]
    }
  },
  "page_content": {
    "introduction": [
      "This tool models payments for variable-rate student loans and computes a balance-weighted average rate for up to three loans. It provides current periodic payment estimates and a conservative projection of the payment after the next scheduled rate adjustment.",
      "The calculator is intended for planning and comparison only. It uses user-provided assumptions about index movement, margins, caps, and adjustment timing. Real-world payments may differ because of changing principal between adjustments, fees, differing amortization rules, or lender-specific rounding."
    ],
    "methodology": [
      "Current payment calculation uses standard amortization: periodic payment = P * r / (1 - (1 + r)^-N), where r is the periodic rate and N is total payments. For variable-rate projections the tool estimates the next rate as index + margin, then bounds that value by any contractual floor or ceiling.",
      "Weighted-average calculations compute a balance-weighted annual rate: sum(balance_i * rate_i) / sum(balance_i). That aggregate rate is converted to a periodic rate and used in the same amortization formula to estimate an equivalent payment.",
      "Security, quality, and accuracy guidance used in development: NIST best practices for software quality and secure handling of inputs, ISO guidance for quality management and traceability, and IEEE recommendations for numerical calculations and disclosure of accuracy and assumptions."
    ],
    "how_is_calculated": [
      "Periodic payment formula: payment = P * r / (1 - (1 + r)^-N). P = principal, r = periodic rate (annual_rate / payments_per_year), N = total_payments.",
      "Projected next annual rate = min(max(index + expected_index_change + margin, floor), ceiling). Values expressed in percent are converted to decimals (divide by 100) before use in formulas.",
      "Weighted annual rate = (sum(balance_i * rate_i) / sum(balance_i)). Convert percent to decimal and then to periodic rate for payment calculation."
    ],
    "examples": [
      "Example 1 — Single loan: $20,000 principal, 10 years, 12 payments/year, 5.0% current APR → tool returns approximate monthly payment and total interest.",
      "Example 2 — Projection: Same loan with index 2.5%, margin 2.0%, expected index change 0.5% and a 2% per-adjustment cap → tool projects the bounded next rate and an approximate payment after adjustment.",
      "Example 3 — Multiple loans: loan1 $10,000@4.5%, loan2 $5,000@6.0%, loan3 $5,000@5.0% → tool computes a weighted rate and equivalent single-loan payment for comparison."
    ],
    "summary": [
      "Use the single-loan method to see current payments and a conservative projection for the next adjustment. Use the weighted-average method to consolidate multiple loans into an equivalent rate/payment for comparison or refinancing consideration.",
      "Always compare results with statements from your servicer and read loan documents for exact terms (index definition, rounding, caps, and amortization rules)."
    ],
    "faqs": [
      {
        "question": "Does this calculator predict exact future payments?",
        "answer": "No. This calculator projects based on user assumptions and simple bounding rules. It does not simulate full amortization between adjustments or servicer-specific rounding, and it does not access live index values. Use it for planning and scenario comparison only."
      },
      {
        "question": "How are index changes handled?",
        "answer": "You provide an expected change for the index at the next adjustment. The tool computes index + margin, then applies contractual floor and ceiling limits. It is a deterministic projection, not a market forecast."
      },
      {
        "question": "Is the weighted-average rate exact when consolidating loans?",
        "answer": "The weighted-average rate is a balance-weighted arithmetic mean of provided rates. It is useful for estimating an equivalent single-loan payment but does not replace detailed loan-by-loan amortization when payments or terms differ."
      },
      {
        "question": "What accuracy and security standards were considered?",
        "answer": "Development followed public best practices for software quality and security; guidance from NIST for secure handling of inputs, ISO for quality management, and IEEE recommendations for numeric methods were considered. This tool includes clear caveats about limitations and does not store or transmit user data."
      }
    ],
    "citations": [
      {
        "label": "NIST — National Institute of Standards and Technology",
        "url": "https://www.nist.gov/"
      },
      {
        "label": "ISO — International Organization for Standardization",
        "url": "https://www.iso.org/"
      },
      {
        "label": "IEEE Standards Association",
        "url": "https://standards.ieee.org/"
      },
      {
        "label": "OSHA — Occupational Safety and Health Administration",
        "url": "https://www.osha.gov/"
      }
    ],
    "glossary": [
      {
        "term": "Index",
        "definition": "A published reference rate (for example a treasury or overnight rate) that, plus a lender margin, determines the variable interest rate for the loan."
      },
      {
        "term": "Margin",
        "definition": "A fixed percentage added to the index by the lender to compute the borrower's rate."
      },
      {
        "term": "Rate floor",
        "definition": "A minimum contractual annual rate that the loan cannot fall below."
      },
      {
        "term": "Rate ceiling",
        "definition": "A maximum contractual annual rate that the loan cannot exceed."
      },
      {
        "term": "Periodic rate",
        "definition": "The interest rate for a single payment period (annual rate divided by number of payments per year)."
      },
      {
        "term": "Weighted-average rate",
        "definition": "An aggregate rate computed by weighting each loan's rate by its balance, useful for creating an equivalent single-loan comparison."
      }
    ]
  },
  "links": {
    "external": [
      {
        "url": "https://www.nist.gov/",
        "label": "NIST: standards and guidance",
        "rel": [
          "noopener",
          "noreferrer"
        ]
      },
      {
        "url": "https://www.iso.org/",
        "label": "ISO: standards catalogue",
        "rel": [
          "noopener",
          "noreferrer"
        ]
      }
    ]
  },
  "schema": {
    "additionalTypes": [
      "HowTo",
      "FinancialCalculations"
    ]
  }
}