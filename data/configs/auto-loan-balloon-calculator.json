{
  "version": "1.0.0",
  "metadata": {
    "title": "Auto Loan Balloon Calculator (multi-mode)",
    "description": "Calculate periodic payment, balloon amount, loan principal, or remaining balance for an auto loan with a balloon payment. Supports configurable payment frequency, APR, and term. Includes accuracy caveats and standards references."
  },
  "logic": {
    "type": "advanced",
    "defaultMethod": "payment_from_loan_balloon",
    "methods": {
      "payment_from_loan_balloon": {
        "label": "Periodic payment from loan + balloon",
        "description": "Compute the fixed periodic payment when a lump-sum balloon is due at the end of the term.",
        "variables": {
          "r": {
            "expression": "annual_rate_pct / 100 / payments_per_year",
            "dependencies": [
              "annual_rate_pct",
              "payments_per_year"
            ],
            "label": "Periodic interest rate",
            "unit": "",
            "format": "decimal",
            "display": true
          },
          "n": {
            "expression": "term_years * payments_per_year",
            "dependencies": [
              "term_years",
              "payments_per_year"
            ],
            "label": "Total number of payments",
            "unit": "periods",
            "format": "integer",
            "display": true
          },
          "discount_factor": {
            "expression": "pow(1 + r, -n)",
            "dependencies": [
              "r",
              "n"
            ],
            "label": "Discount factor for balloon",
            "unit": "",
            "format": "decimal",
            "display": false
          },
          "annuity_factor": {
            "expression": "(1 - discount_factor) / r",
            "dependencies": [
              "discount_factor",
              "r"
            ],
            "label": "Annuity factor",
            "unit": "",
            "format": "decimal",
            "display": false
          },
          "periodic_payment": {
            "expression": "(loan_amount - balloon_amount * discount_factor) / annuity_factor",
            "dependencies": [
              "loan_amount",
              "balloon_amount",
              "discount_factor",
              "annuity_factor"
            ],
            "label": "Periodic payment",
            "unit": "currency",
            "format": "currency",
            "display": true
          }
        },
        "outputs": [
          {
            "id": "periodic_payment",
            "label": "Periodic payment (per period)",
            "variable": "periodic_payment",
            "unit": "",
            "format": "currency"
          }
        ]
      },
      "balloon_from_payment": {
        "label": "Balloon amount from payment",
        "description": "Compute the required balloon lump sum at the end of the term given a fixed periodic payment.",
        "variables": {
          "r": {
            "expression": "annual_rate_pct / 100 / payments_per_year",
            "dependencies": [
              "annual_rate_pct",
              "payments_per_year"
            ],
            "label": "Periodic interest rate",
            "unit": "",
            "format": "decimal",
            "display": false
          },
          "n": {
            "expression": "term_years * payments_per_year",
            "dependencies": [
              "term_years",
              "payments_per_year"
            ],
            "label": "Total number of payments",
            "unit": "periods",
            "format": "integer",
            "display": false
          },
          "discount_factor": {
            "expression": "pow(1 + r, -n)",
            "dependencies": [
              "r",
              "n"
            ],
            "label": "Discount factor",
            "unit": "",
            "format": "decimal",
            "display": false
          },
          "annuity_factor": {
            "expression": "(1 - discount_factor) / r",
            "dependencies": [
              "discount_factor",
              "r"
            ],
            "label": "Annuity factor",
            "unit": "",
            "format": "decimal",
            "display": false
          },
          "balloon_amount_computed": {
            "expression": "(loan_amount - payment_amount * annuity_factor) * pow(1 + r, n)",
            "dependencies": [
              "loan_amount",
              "payment_amount",
              "annuity_factor",
              "r",
              "n"
            ],
            "label": "Balloon amount due at term",
            "unit": "currency",
            "format": "currency",
            "display": true
          }
        },
        "outputs": [
          {
            "id": "balloon_amount_computed",
            "label": "Balloon amount (due at end of term)",
            "variable": "balloon_amount_computed",
            "unit": "",
            "format": "currency"
          }
        ]
      },
      "loan_from_payment_balloon": {
        "label": "Loan principal from payment + balloon",
        "description": "Compute the original loan principal that corresponds to a given periodic payment and balloon amount.",
        "variables": {
          "r": {
            "expression": "annual_rate_pct / 100 / payments_per_year",
            "dependencies": [
              "annual_rate_pct",
              "payments_per_year"
            ],
            "label": "Periodic interest rate",
            "unit": "",
            "format": "decimal",
            "display": false
          },
          "n": {
            "expression": "term_years * payments_per_year",
            "dependencies": [
              "term_years",
              "payments_per_year"
            ],
            "label": "Total number of payments",
            "unit": "periods",
            "format": "integer",
            "display": false
          },
          "discount_factor": {
            "expression": "pow(1 + r, -n)",
            "dependencies": [
              "r",
              "n"
            ],
            "label": "Discount factor for balloon",
            "unit": "",
            "format": "decimal",
            "display": false
          },
          "annuity_factor": {
            "expression": "(1 - discount_factor) / r",
            "dependencies": [
              "discount_factor",
              "r"
            ],
            "label": "Annuity factor",
            "unit": "",
            "format": "decimal",
            "display": false
          },
          "loan_amount_computed": {
            "expression": "payment_amount * annuity_factor + balloon_amount * discount_factor",
            "dependencies": [
              "payment_amount",
              "annuity_factor",
              "balloon_amount",
              "discount_factor"
            ],
            "label": "Implied loan principal",
            "unit": "currency",
            "format": "currency",
            "display": true
          }
        },
        "outputs": [
          {
            "id": "loan_amount_computed",
            "label": "Loan principal",
            "variable": "loan_amount_computed",
            "unit": "",
            "format": "currency"
          }
        ]
      },
      "balance_after_payments": {
        "label": "Outstanding balance after N payments",
        "description": "Estimate remaining principal after a specified number of payments (useful for payoff or trade-in planning).",
        "variables": {
          "r": {
            "expression": "annual_rate_pct / 100 / payments_per_year",
            "dependencies": [
              "annual_rate_pct",
              "payments_per_year"
            ],
            "label": "Periodic interest rate",
            "unit": "",
            "format": "decimal",
            "display": false
          },
          "k": {
            "expression": "payments_made",
            "dependencies": [
              "payments_made"
            ],
            "label": "Payments made",
            "unit": "periods",
            "format": "integer",
            "display": false
          },
          "accum_factor": {
            "expression": "pow(1 + r, k)",
            "dependencies": [
              "r",
              "k"
            ],
            "label": "Accumulation factor",
            "unit": "",
            "format": "decimal",
            "display": false
          },
          "outstanding_balance": {
            "expression": "loan_amount * accm_factor_safe - payment_amount * (accm_factor_safe - 1) / r",
            "dependencies": [
              "loan_amount",
              "payment_amount",
              "accum_factor",
              "r"
            ],
            "label": "Outstanding balance after k payments",
            "unit": "currency",
            "format": "currency",
            "display": true
          },
          "accm_factor_safe": {
            "expression": "pow(1 + r, k)",
            "dependencies": [
              "r",
              "k"
            ],
            "label": "Accumulation factor (safe alias)",
            "unit": "",
            "format": "decimal",
            "display": false
          }
        },
        "outputs": [
          {
            "id": "outstanding_balance",
            "label": "Outstanding balance",
            "variable": "outstanding_balance",
            "unit": "",
            "format": "currency"
          }
        ]
      }
    }
  },
  "form": {
    "fields": [
      {
        "id": "method",
        "label": "Calculation type",
        "type": "select",
        "default": "payment_from_loan_balloon",
        "options": [
          {
            "label": "Periodic payment from loan + balloon",
            "value": "payment_from_loan_balloon"
          },
          {
            "label": "Balloon amount from payment",
            "value": "balloon_from_payment"
          },
          {
            "label": "Loan principal from payment + balloon",
            "value": "loan_from_payment_balloon"
          },
          {
            "label": "Outstanding balance after N payments",
            "value": "balance_after_payments"
          }
        ]
      }
    ],
    "sections": [
      {
        "id": "common_terms",
        "label": "Common inputs",
        "fields": [
          {
            "id": "loan_amount",
            "label": "Loan principal (amount financed)",
            "type": "number",
            "default": 20000,
            "min": 0,
            "step": 0.01
          },
          {
            "id": "annual_rate_pct",
            "label": "Annual interest rate (APR %) - nominal",
            "type": "number",
            "default": 5,
            "min": 0,
            "step": 0.001
          },
          {
            "id": "term_years",
            "label": "Term length (years)",
            "type": "number",
            "default": 5,
            "min": 0.25,
            "step": 0.25
          },
          {
            "id": "payments_per_year",
            "label": "Payments per year",
            "type": "select",
            "default": 12,
            "options": [
              {
                "label": "Monthly (12)",
                "value": "12"
              },
              {
                "label": "Quarterly (4)",
                "value": "4"
              }
            ]
          }
        ]
      },
      {
        "id": "balloon_inputs",
        "label": "Balloon details (used by several methods)",
        "show_when": {
          "field": "method",
          "is": "payment_from_loan_balloon"
        },
        "fields": [
          {
            "id": "balloon_amount",
            "label": "Balloon amount due at end of term",
            "type": "number",
            "default": 5000,
            "min": 0,
            "step": 0.01
          }
        ]
      },
      {
        "id": "payment_input_section",
        "label": "Payment input (used by payment-based methods)",
        "show_when": {
          "field": "method",
          "is": "balloon_from_payment"
        },
        "fields": [
          {
            "id": "payment_amount",
            "label": "Periodic payment amount",
            "type": "number",
            "default": 300,
            "min": 0,
            "step": 0.01
          }
        ]
      },
      {
        "id": "loan_and_payment_section",
        "label": "Payment and balloon (loan calculation)",
        "show_when": {
          "field": "method",
          "is": "loan_from_payment_balloon"
        },
        "fields": [
          {
            "id": "payment_amount",
            "label": "Periodic payment amount",
            "type": "number",
            "default": 300,
            "min": 0,
            "step": 0.01
          },
          {
            "id": "balloon_amount",
            "label": "Balloon amount due at end of term",
            "type": "number",
            "default": 5000,
            "min": 0,
            "step": 0.01
          }
        ]
      },
      {
        "id": "balance_section",
        "label": "Balance after N payments",
        "show_when": {
          "field": "method",
          "is": "balance_after_payments"
        },
        "fields": [
          {
            "id": "payment_amount",
            "label": "Periodic payment amount",
            "type": "number",
            "default": 300,
            "min": 0,
            "step": 0.01
          },
          {
            "id": "payments_made",
            "label": "Number of payments already made",
            "type": "integer",
            "default": 12,
            "min": 0,
            "max": 1000,
            "step": 1
          }
        ]
      }
    ]
  },
  "page_content": {
    "introduction": [
      "This calculator covers common auto-loan scenarios that include a balloon payment at the end of the term. Use it to compute the periodic payment given an upfront loan and final balloon, compute the balloon given a payment, infer the loan principal from payment + balloon, or estimate remaining balance after a number of payments.",
      "The tool assumes a nominal annual percentage rate (APR) converted to a periodic rate by dividing by the number of payments per year (for example, 12 for monthly). The balloon is treated as a lump sum payable at the final scheduled period."
    ],
    "methodology": [
      "Calculations use standard time-value-of-money formulas. Present value of the payment stream plus the discounted balloon equals the loan principal. Solve the algebraic form appropriate to the requested unknown.",
      "Periodic interest rate r is APR / 100 / payments_per_year. Number of periods n is term_years * payments_per_year. Annuity factor for a level payment is (1 - (1 + r)^-n) / r. Present-value and future-value relationships follow established finance conventions."
    ],
    "how_is_calculated": [
      "Periodic interest rate r = annual_rate_pct / 100 / payments_per_year",
      "Number of payments n = term_years * payments_per_year",
      "Payment from loan and balloon: A = (P - B * (1 + r)^-n) / [ (1 - (1 + r)^-n) / r ]",
      "Balloon from payment: B = (P - A * [ (1 - (1 + r)^-n) / r ]) * (1 + r)^n",
      "Outstanding balance after k payments: balance = P*(1 + r)^k - A*((1 + r)^k - 1)/r"
    ],
    "examples": [
      "If you borrow 20,000 with a 5% APR, 5-year term, monthly payments and a 5,000 balloon, the calculator returns the monthly payment required to amortize to that balloon.",
      "If you make a fixed monthly payment and want to know the final balloon required for a given principal and term, switch to the balloon calculation mode and enter the payment amount."
    ],
    "faqs": [
      {
        "question": "Does this calculator use APR or nominal rate?",
        "answer": "It expects a nominal APR value. It converts APR to a periodic rate by dividing by the number of payments per year. It does not compute finance charges under specific disclosure rules; use disclosed APR from your lender for regulatory comparisons."
      },
      {
        "question": "What happens at zero interest rate?",
        "answer": "The algebraic forms shown assume a positive interest rate. When the rate is zero, the periodic payment simplifies to (loan_amount - balloon_amount) divided by the number of periods. The tool provides guidance for zero-rate cases but numeric engines may require special handling to avoid division by zero."
      },
      {
        "question": "Are results exact?",
        "answer": "Results are based on standard closed-form formulas and floating-point arithmetic. Rounding, payment timing conventions, compounding differences, and lender-specific fees will affect real-world amounts. See accuracy caveats below."
      }
    ],
    "citations": [
      {
        "label": "NIST - Guidelines and best practices for financial calculations",
        "url": "https://www.nist.gov"
      },
      {
        "label": "ISO - Financial services standards",
        "url": "https://www.iso.org"
      },
      {
        "label": "IEEE - Recommended practices for numeric software",
        "url": "https://www.ieee.org"
      },
      {
        "label": "OSHA - Not applicable for finance, included for compliance reference",
        "url": "https://www.osha.gov"
      }
    ],
    "glossary": [
      {
        "term": "APR",
        "definition": "Annual Percentage Rate; the nominal annual interest rate used here to derive periodic rates by dividing by payments per year."
      },
      {
        "term": "Balloon payment",
        "definition": "A final lump-sum payment due at the end of the loan term that reduces periodic payment amounts during the term."
      },
      {
        "term": "Annuity factor",
        "definition": "The factor (1 - (1 + r)^-n) / r used to convert a level periodic payment into its present value."
      },
      {
        "term": "Discount factor",
        "definition": "Pow(1 + r, -n), the present-value multiplier for a cash flow n periods in the future."
      }
    ],
    "summary": [
      "Use the mode selector to pick whether you want payment, balloon, loan principal, or outstanding balance calculations.",
      "Provide nominal APR, payment frequency, term, and the known monetary values. Verify results against lender disclosures and consider rounding and fees."
    ]
  },
  "links": {
    "internal": [],
    "external": [
      {
        "url": "https://www.nist.gov",
        "label": "NIST",
        "rel": [
          "noopener",
          "noreferrer"
        ]
      },
      {
        "url": "https://www.iso.org",
        "label": "ISO",
        "rel": [
          "noopener",
          "noreferrer"
        ]
      },
      {
        "url": "https://www.ieee.org",
        "label": "IEEE",
        "rel": [
          "noopener",
          "noreferrer"
        ]
      }
    ]
  },
  "schema": {
    "additionalTypes": [
      "HowTo"
    ]
  }
}
