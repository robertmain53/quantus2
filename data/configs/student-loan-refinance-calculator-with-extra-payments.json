{
  "version": "1.0.0",
  "metadata": {
    "title": "Student Loan Refinance & Extra Payments Calculator (Advanced)",
    "description": "Compare your current student loan plan to a refinance offer and model extra monthly payments. Calculates scheduled payments, time-to-payoff with extra payments, total interest, and net savings including refinance fees."
  },
  "logic": {
    "type": "advanced",
    "defaultMethod": "comparison",
    "methods": {
      "current_plan": {
        "label": "Current loan plan",
        "description": "Calculations for your existing loan using the inputs for the current loan and optional extra monthly payments.",
        "variables": {
          "n_months_current": {
            "expression": "term_years_current * 12",
            "dependencies": [
              "term_years_current"
            ],
            "label": "Term (months)",
            "unit": "months",
            "format": "integer",
            "display": true
          },
          "monthly_rate_current": {
            "expression": "annual_rate_current / 12 / 100",
            "dependencies": [
              "annual_rate_current"
            ],
            "label": "Monthly interest rate",
            "unit": "%",
            "format": "decimal",
            "display": true
          },
          "scheduled_payment_current_var": {
            "expression": "principal_current * (monthly_rate_current * (1 + monthly_rate_current) ** n_months_current) / ((1 + monthly_rate_current) ** n_months_current - 1)",
            "dependencies": [
              "principal_current",
              "monthly_rate_current",
              "n_months_current"
            ],
            "label": "Scheduled monthly payment (no extra)",
            "unit": "currency",
            "format": "currency",
            "display": true
          },
          "payoff_months_current": {
            "expression": "-ln(1 - (monthly_rate_current * principal_current) / (scheduled_payment_current_var + extra_monthly_current)) / ln(1 + monthly_rate_current)",
            "dependencies": [
              "monthly_rate_current",
              "principal_current",
              "scheduled_payment_current_var",
              "extra_monthly_current"
            ],
            "label": "Estimated months to payoff (with extra payments)",
            "unit": "months",
            "format": "decimal",
            "display": true
          },
          "total_paid_current": {
            "expression": "(scheduled_payment_current_var + extra_monthly_current) * payoff_months_current",
            "dependencies": [
              "scheduled_payment_current_var",
              "extra_monthly_current",
              "payoff_months_current"
            ],
            "label": "Total amount paid (with extras)",
            "unit": "currency",
            "format": "currency",
            "display": true
          },
          "total_interest_current": {
            "expression": "total_paid_current - principal_current",
            "dependencies": [
              "total_paid_current",
              "principal_current"
            ],
            "label": "Total interest paid (with extras)",
            "unit": "currency",
            "format": "currency",
            "display": true
          }
        },
        "outputs": [
          {
            "id": "scheduled_payment_current",
            "label": "Scheduled payment (no extra)",
            "variable": "scheduled_payment_current_var",
            "unit": "currency",
            "format": "currency"
          },
          {
            "id": "payoff_months_current",
            "label": "Months to payoff (with extras)",
            "variable": "payoff_months_current",
            "unit": "months",
            "format": "decimal"
          },
          {
            "id": "total_paid_current",
            "label": "Total paid (with extras)",
            "variable": "total_paid_current",
            "unit": "currency",
            "format": "currency"
          },
          {
            "id": "total_interest_current",
            "label": "Total interest (with extras)",
            "variable": "total_interest_current",
            "unit": "currency",
            "format": "currency"
          }
        ]
      },
      "refinance_plan": {
        "label": "Refinance offer",
        "description": "Calculations for the refinance scenario including optional extra payments and one-time refinance fees.",
        "variables": {
          "n_months_refi": {
            "expression": "term_years_refi * 12",
            "dependencies": [
              "term_years_refi"
            ],
            "label": "Term (months)",
            "unit": "months",
            "format": "integer",
            "display": true
          },
          "monthly_rate_refi": {
            "expression": "annual_rate_refi / 12 / 100",
            "dependencies": [
              "annual_rate_refi"
            ],
            "label": "Monthly interest rate",
            "unit": "%",
            "format": "decimal",
            "display": true
          },
          "scheduled_payment_refi_var": {
            "expression": "principal_refi * (monthly_rate_refi * (1 + monthly_rate_refi) ** n_months_refi) / ((1 + monthly_rate_refi) ** n_months_refi - 1)",
            "dependencies": [
              "principal_refi",
              "monthly_rate_refi",
              "n_months_refi"
            ],
            "label": "Scheduled monthly payment (no extra)",
            "unit": "currency",
            "format": "currency",
            "display": true
          },
          "payoff_months_refi": {
            "expression": "-ln(1 - (monthly_rate_refi * principal_refi) / (scheduled_payment_refi_var + extra_monthly_refi)) / ln(1 + monthly_rate_refi)",
            "dependencies": [
              "monthly_rate_refi",
              "principal_refi",
              "scheduled_payment_refi_var",
              "extra_monthly_refi"
            ],
            "label": "Estimated months to payoff (with extra payments)",
            "unit": "months",
            "format": "decimal",
            "display": true
          },
          "total_paid_refi": {
            "expression": "(scheduled_payment_refi_var + extra_monthly_refi) * payoff_months_refi",
            "dependencies": [
              "scheduled_payment_refi_var",
              "extra_monthly_refi",
              "payoff_months_refi"
            ],
            "label": "Total amount paid (with extras)",
            "unit": "currency",
            "format": "currency",
            "display": true
          },
          "total_interest_refi": {
            "expression": "total_paid_refi - principal_refi",
            "dependencies": [
              "total_paid_refi",
              "principal_refi"
            ],
            "label": "Total interest paid (with extras)",
            "unit": "currency",
            "format": "currency",
            "display": true
          },
          "total_cost_refi_including_fees": {
            "expression": "total_paid_refi + refi_fees",
            "dependencies": [
              "total_paid_refi",
              "refi_fees"
            ],
            "label": "Total cost including refinance fees",
            "unit": "currency",
            "format": "currency",
            "display": true
          }
        },
        "outputs": [
          {
            "id": "scheduled_payment_refi",
            "label": "Scheduled payment (no extra)",
            "variable": "scheduled_payment_refi_var",
            "unit": "currency",
            "format": "currency"
          },
          {
            "id": "payoff_months_refi",
            "label": "Months to payoff (with extras)",
            "variable": "payoff_months_refi",
            "unit": "months",
            "format": "decimal"
          },
          {
            "id": "total_paid_refi",
            "label": "Total paid (with extras)",
            "variable": "total_paid_refi",
            "unit": "currency",
            "format": "currency"
          },
          {
            "id": "total_interest_refi",
            "label": "Total interest (with extras)",
            "variable": "total_interest_refi",
            "unit": "currency",
            "format": "currency"
          },
          {
            "id": "total_cost_refi_including_fees",
            "label": "Total cost (including refinance fees)",
            "variable": "total_cost_refi_including_fees",
            "unit": "currency",
            "format": "currency"
          }
        ]
      },
      "comparison": {
        "label": "Comparison & net savings",
        "description": "Compares current plan and refinance plan outputs and shows interest, time, and net savings after fees.",
        "variables": {
          "n_months_current_c": {
            "expression": "term_years_current * 12",
            "dependencies": [
              "term_years_current"
            ],
            "label": "Current term (months)",
            "unit": "months",
            "format": "integer",
            "display": false
          },
          "monthly_rate_current_c": {
            "expression": "annual_rate_current / 12 / 100",
            "dependencies": [
              "annual_rate_current"
            ],
            "label": "Current monthly rate",
            "unit": "%",
            "format": "decimal",
            "display": false
          },
          "scheduled_payment_current_c": {
            "expression": "principal_current * (monthly_rate_current_c * (1 + monthly_rate_current_c) ** n_months_current_c) / ((1 + monthly_rate_current_c) ** n_months_current_c - 1)",
            "dependencies": [
              "principal_current",
              "monthly_rate_current_c",
              "n_months_current_c"
            ],
            "label": "Scheduled current payment",
            "unit": "currency",
            "format": "currency",
            "display": false
          },
          "payoff_months_current_c": {
            "expression": "-ln(1 - (monthly_rate_current_c * principal_current) / (scheduled_payment_current_c + extra_monthly_current)) / ln(1 + monthly_rate_current_c)",
            "dependencies": [
              "monthly_rate_current_c",
              "principal_current",
              "scheduled_payment_current_c",
              "extra_monthly_current"
            ],
            "label": "Current payoff months (with extras)",
            "unit": "months",
            "format": "decimal",
            "display": false
          },
          "total_paid_current_c": {
            "expression": "(scheduled_payment_current_c + extra_monthly_current) * payoff_months_current_c",
            "dependencies": [
              "scheduled_payment_current_c",
              "extra_monthly_current",
              "payoff_months_current_c"
            ],
            "label": "Current total paid (with extras)",
            "unit": "currency",
            "format": "currency",
            "display": false
          },
          "total_interest_current_c": {
            "expression": "total_paid_current_c - principal_current",
            "dependencies": [
              "total_paid_current_c",
              "principal_current"
            ],
            "label": "Current total interest (with extras)",
            "unit": "currency",
            "format": "currency",
            "display": false
          },
          "n_months_refi_c": {
            "expression": "term_years_refi * 12",
            "dependencies": [
              "term_years_refi"
            ],
            "label": "Refinance term (months)",
            "unit": "months",
            "format": "integer",
            "display": false
          },
          "monthly_rate_refi_c": {
            "expression": "annual_rate_refi / 12 / 100",
            "dependencies": [
              "annual_rate_refi"
            ],
            "label": "Refinance monthly rate",
            "unit": "%",
            "format": "decimal",
            "display": false
          },
          "scheduled_payment_refi_c": {
            "expression": "principal_refi * (monthly_rate_refi_c * (1 + monthly_rate_refi_c) ** n_months_refi_c) / ((1 + monthly_rate_refi_c) ** n_months_refi_c - 1)",
            "dependencies": [
              "principal_refi",
              "monthly_rate_refi_c",
              "n_months_refi_c"
            ],
            "label": "Scheduled refinance payment",
            "unit": "currency",
            "format": "currency",
            "display": false
          },
          "payoff_months_refi_c": {
            "expression": "-ln(1 - (monthly_rate_refi_c * principal_refi) / (scheduled_payment_refi_c + extra_monthly_refi)) / ln(1 + monthly_rate_refi_c)",
            "dependencies": [
              "monthly_rate_refi_c",
              "principal_refi",
              "scheduled_payment_refi_c",
              "extra_monthly_refi"
            ],
            "label": "Refinance payoff months (with extras)",
            "unit": "months",
            "format": "decimal",
            "display": false
          },
          "total_paid_refi_c": {
            "expression": "(scheduled_payment_refi_c + extra_monthly_refi) * payoff_months_refi_c",
            "dependencies": [
              "scheduled_payment_refi_c",
              "extra_monthly_refi",
              "payoff_months_refi_c"
            ],
            "label": "Refinance total paid (with extras)",
            "unit": "currency",
            "format": "currency",
            "display": false
          },
          "total_interest_refi_c": {
            "expression": "total_paid_refi_c - principal_refi",
            "dependencies": [
              "total_paid_refi_c",
              "principal_refi"
            ],
            "label": "Refinance total interest (with extras)",
            "unit": "currency",
            "format": "currency",
            "display": false
          },
          "interest_saved": {
            "expression": "total_interest_current_c - total_interest_refi_c",
            "dependencies": [
              "total_interest_current_c",
              "total_interest_refi_c"
            ],
            "label": "Interest saved by refinancing",
            "unit": "currency",
            "format": "currency",
            "display": true
          },
          "months_saved": {
            "expression": "payoff_months_current_c - payoff_months_refi_c",
            "dependencies": [
              "payoff_months_current_c",
              "payoff_months_refi_c"
            ],
            "label": "Months saved",
            "unit": "months",
            "format": "decimal",
            "display": true
          },
          "net_savings_after_fees": {
            "expression": "interest_saved - refi_fees",
            "dependencies": [
              "interest_saved",
              "refi_fees"
            ],
            "label": "Net savings after refinance fees",
            "unit": "currency",
            "format": "currency",
            "display": true
          },
          "refinance_break_even_months": {
            "expression": "refi_fees / max(0.000001, (total_paid_current_c - total_paid_refi_c) / max(1, payoff_months_current_c))",
            "dependencies": [
              "refi_fees",
              "total_paid_current_c",
              "total_paid_refi_c",
              "payoff_months_current_c"
            ],
            "label": "Approximate break-even months",
            "unit": "months",
            "format": "decimal",
            "display": true
          }
        },
        "outputs": [
          {
            "id": "interest_saved",
            "label": "Interest saved",
            "variable": "interest_saved",
            "unit": "currency",
            "format": "currency"
          },
          {
            "id": "months_saved",
            "label": "Months saved",
            "variable": "months_saved",
            "unit": "months",
            "format": "decimal"
          },
          {
            "id": "net_savings_after_fees",
            "label": "Net savings after fees",
            "variable": "net_savings_after_fees",
            "unit": "currency",
            "format": "currency"
          },
          {
            "id": "refinance_break_even_months",
            "label": "Approximate break-even (months)",
            "variable": "refinance_break_even_months",
            "unit": "months",
            "format": "decimal"
          }
        ]
      }
    }
  },
  "form": {
    "fields": [
      {
        "id": "principal_current",
        "label": "Current loan principal",
        "type": "number",
        "default": 35000,
        "min": 0,
        "step": 100
      },
      {
        "id": "annual_rate_current",
        "label": "Current loan interest rate (APR %)",
        "type": "number",
        "default": 6.8,
        "min": 0,
        "max": 100,
        "step": 0.01
      },
      {
        "id": "term_years_current",
        "label": "Current remaining term (years)",
        "type": "number",
        "default": 10,
        "min": 0.1,
        "max": 40,
        "step": 0.5
      },
      {
        "id": "extra_monthly_current",
        "label": "Extra monthly payment (current loan)",
        "type": "number",
        "default": 0,
        "min": 0,
        "step": 10
      },
      {
        "id": "principal_refi",
        "label": "Refinance principal (amount to refinance)",
        "type": "number",
        "default": 35000,
        "min": 0,
        "step": 100
      },
      {
        "id": "annual_rate_refi",
        "label": "Refinance interest rate (APR %)",
        "type": "number",
        "default": 4.5,
        "min": 0,
        "max": 100,
        "step": 0.01
      },
      {
        "id": "term_years_refi",
        "label": "Refinance term (years)",
        "type": "number",
        "default": 10,
        "min": 0.1,
        "max": 40,
        "step": 0.5
      },
      {
        "id": "extra_monthly_refi",
        "label": "Extra monthly payment (refinance loan)",
        "type": "number",
        "default": 0,
        "min": 0,
        "step": 10
      },
      {
        "id": "refi_fees",
        "label": "One-time refinance fees (closing costs)",
        "type": "number",
        "default": 0,
        "min": 0,
        "step": 10
      }
    ],
    "result": {
      "outputs": [
        {
          "id": "scheduled_payment_current",
          "label": "Current scheduled monthly payment"
        },
        {
          "id": "payoff_months_current",
          "label": "Months to payoff (current with extras)",
          "format": "decimal",
          "unit": "months"
        },
        {
          "id": "total_interest_current",
          "label": "Total interest (current with extras)",
          "format": "currency"
        },
        {
          "id": "scheduled_payment_refi",
          "label": "Refinance scheduled monthly payment"
        },
        {
          "id": "payoff_months_refi",
          "label": "Months to payoff (refinance with extras)",
          "format": "decimal",
          "unit": "months"
        },
        {
          "id": "total_interest_refi",
          "label": "Total interest (refinance with extras)",
          "format": "currency"
        },
        {
          "id": "interest_saved",
          "label": "Interest saved by refinancing",
          "format": "currency"
        },
        {
          "id": "months_saved",
          "label": "Months saved",
          "format": "decimal",
          "unit": "months"
        },
        {
          "id": "net_savings_after_fees",
          "label": "Net savings after fees",
          "format": "currency"
        },
        {
          "id": "refinance_break_even_months",
          "label": "Approximate break-even months",
          "format": "decimal",
          "unit": "months"
        }
      ]
    }
  },
  "page_content": {
    "introduction": [
      "This tool helps you compare your existing student loan to a refinance offer and estimate the impact of extra monthly payments. It shows scheduled payments, estimated time to payoff when extra payments are applied, total interest paid, and net savings after refinance fees.",
      "Use realistic numbers for principal, APR, and fees. Results are estimates intended to support decision-making and do not substitute for lender-provided disclosure statements or professional financial advice."
    ],
    "methodology": [
      "Payments are computed using standard amortization formulas for fixed-rate loans. Monthly interest rate is annual APR divided by 12. Scheduled monthly payment uses the annuity formula.",
      "Time-to-payoff with extra payments is estimated by solving the amortization equation for the number of payments required when monthly payment is increased by the extra monthly amount. When extra payments are zero, time-to-payoff equals the scheduled term.",
      "Quality and numeric handling follow general industry practices: numerical precision expectations are aligned with IEEE 754 floating-point conventions, and development, access control, and data handling follow NIST guidance for secure handling and testing. Quality management for the calculation workflow follows ISO 9001 principles. This tool is informational and not a regulated financial product."
    ],
    "how_is_calculated": [
      "monthly_rate = annual_rate / 12 / 100",
      "scheduled_payment = principal * (r * (1 + r)^n) / ((1 + r)^n - 1) where r = monthly_rate and n = term_years * 12",
      "payoff_months_with_extra = -ln(1 - (r * principal) / (scheduled_payment + extra)) / ln(1 + r)",
      "total_paid = (scheduled_payment + extra) * payoff_months_with_extra",
      "total_interest = total_paid - principal",
      "net_savings = (total_interest_current - total_interest_refi) - refinance_fees"
    ],
    "examples": [
      "Example: $35,000 current balance at 6.8% for 10 years vs. refinance to 4.5% for 10 years. With no extra payments, compare scheduled payments, total interest, and net savings after any refinance fees.",
      "Example: Adding $50 extra per month often reduces payoff time and interest significantly; run both scenarios with matching extra payments to compare impact."
    ],
    "faqs": [
      {
        "question": "Are results exact?",
        "answer": "Results are estimates. They assume fixed-rate loans, monthly compounding, and that extra payments are applied monthly against principal. They do not account for variable-rate changes, deferred periods, loan forgiveness programs, income-driven repayment adjustments, or lender-specific rounding rules."
      },
      {
        "question": "Do you include refinance fees?",
        "answer": "Yes. You can enter one-time refinance fees which are added to the refinance scenario when computing net savings and break-even estimates."
      },
      {
        "question": "What if extra payments are large?",
        "answer": "If the extra payment plus scheduled payment would be less than monthly interest (an interest-only or negative amortization case), the model will produce values that indicate payoff is not achieved under those parameters. Adjust inputs or consult your servicer if you see unexpected results."
      },
      {
        "question": "Is this financial advice?",
        "answer": "No. This calculator provides numeric estimates to inform decisions. Consult a qualified financial advisor or your loan servicer before refinancing or changing payments."
      }
    ],
    "citations": [
      {
        "label": "NIST - Security and privacy controls for federal information systems and organizations",
        "url": "https://www.nist.gov/publications"
      },
      {
        "label": "ISO - Quality management systems (ISO 9001)",
        "url": "https://www.iso.org/iso-9001-quality-management.html"
      },
      {
        "label": "IEEE - IEEE standards association",
        "url": "https://standards.ieee.org"
      },
      {
        "label": "OSHA - Not applicable to financial calculations; referenced for compliance context",
        "url": "https://www.osha.gov"
      }
    ],
    "glossary": [
      {
        "term": "APR",
        "definition": "Annual Percentage Rate; the annual rate charged for borrowing, expressed as a single percentage number that represents the yearly cost of funds."
      },
      {
        "term": "Amortization",
        "definition": "The process of paying off debt over time through regular payments of principal and interest."
      },
      {
        "term": "Extra monthly payment",
        "definition": "An additional amount paid each month on top of the scheduled payment, applied directly to principal to reduce interest and shorten payoff time."
      },
      {
        "term": "Refinance fees",
        "definition": "One-time closing or origination costs associated with refinancing a loan. Include these when evaluating net savings."
      },
      {
        "term": "Break-even",
        "definition": "The time required for interest savings from refinancing to equal the refinance fees paid."
      }
    ]
  },
  "links": {
    "external": [
      {
        "url": "https://www.nist.gov",
        "label": "NIST home",
        "rel": [
          "noopener",
          "noreferrer"
        ]
      },
      {
        "url": "https://www.iso.org",
        "label": "ISO home",
        "rel": [
          "noopener",
          "noreferrer"
        ]
      },
      {
        "url": "https://standards.ieee.org",
        "label": "IEEE Standards",
        "rel": [
          "noopener",
          "noreferrer"
        ]
      }
    ]
  },
  "schema": {
    "additionalTypes": [
      "HowTo"
    ]
  }
}