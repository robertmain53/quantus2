{
  "version": "1.0.0",
  "metadata": {
    "title": "Discounted Payback Period Calculator",
    "description": "Calculate the discounted payback period (years) for an investment with uniform periodic cash flows. Provides undiscounted payback for comparison and built-in guards for edge conditions."
  },
  "logic": {
    "type": "formula",
    "outputs": [
      {
        "id": "dpp_years",
        "label": "Discounted payback period (years)",
        "expression": "(periodic_cash_flow<=0) ? Infinity : ((discount_rate===0) ? (initial_investment/periodic_cash_flow) : (((1 - (initial_investment * discount_rate / periodic_cash_flow))>0) ? (-Math.log(1 - (initial_investment * discount_rate / periodic_cash_flow))) / Math.log(1 + discount_rate) : Infinity))",
        "unit": "years",
        "format": "decimal"
      },
      {
        "id": "payback_years",
        "label": "Undiscounted payback period (years)",
        "expression": "(periodic_cash_flow<=0) ? Infinity : initial_investment/periodic_cash_flow",
        "unit": "years",
        "format": "decimal"
      },
      {
        "id": "initial_recovered_pct_at_undiscounted_payback",
        "label": "Percent of initial investment recovered by undiscounted payback (%)",
        "expression": "(periodic_cash_flow<=0) ? 0 : Math.min(100, (Math.min(payback_years, Math.floor(payback_years)) * periodic_cash_flow + ((payback_years - Math.floor(payback_years)) * periodic_cash_flow)) / initial_investment * 100)",
        "unit": "%",
        "format": "percent"
      }
    ]
  },
  "form": {
    "fields": [
      {
        "id": "initial_investment",
        "label": "Initial investment (positive cash outflow)",
        "type": "number",
        "default": 10000,
        "min": 0,
        "step": 100
      },
      {
        "id": "periodic_cash_flow",
        "label": "Periodic (uniform) after-tax cash inflow per period",
        "type": "number",
        "default": 3000,
        "min": 0,
        "step": 1
      },
      {
        "id": "discount_rate",
        "label": "Discount rate (decimal)",
        "type": "number",
        "default": 0.08,
        "min": 0,
        "max": 1,
        "step": 0.0001
      },
      {
        "id": "max_evaluation_periods",
        "label": "Maximum evaluation periods (used for context and validation)",
        "type": "integer",
        "default": 30,
        "min": 1,
        "max": 100,
        "step": 1
      }
    ],
    "result": {
      "outputs": [
        {
          "id": "dpp_years",
          "label": "Discounted payback period (years)",
          "format": "decimal",
          "unit": "years"
        },
        {
          "id": "payback_years",
          "label": "Undiscounted payback period (years)",
          "format": "decimal",
          "unit": "years"
        },
        {
          "id": "initial_recovered_pct_at_undiscounted_payback",
          "label": "Recovered % at undiscounted payback",
          "format": "percent",
          "unit": "%"
        }
      ]
    }
  },
  "page_content": {
    "introduction": [
      "The discounted payback period (DPP) estimates how long it takes for the present value of cash inflows to equal the initial investment, expressed in years. Unlike the simple payback, DPP accounts for the time value of money by discounting future cash flows.",
      "This tool computes DPP for projects with uniform periodic after-tax cash inflows. It also returns the undiscounted payback period for quick comparison and includes guards for edge cases (zero cash flow, zero discount rate, or impossible recovery)."
    ],
    "methodology": [
      "We assume evenly spaced, uniform cash inflows (same amount each period). For this case the cumulative present value of cash inflows up to time t is CF * (1 - (1+ r)^-t) / r where CF is the periodic cash inflow and r is the decimal discount rate per period.",
      "To find the discounted payback time t (possibly fractional), we invert the cumulative present value formula to solve for t: t = -ln(1 - (Initial * r / CF)) / ln(1 + r). The calculator falls back to the undiscounted payback when the discount rate is zero, and returns Infinity when recovery is not possible under the provided inputs."
    ],
    "how_is_calculated": [
      "Let Initial = initial investment (positive number), CF = uniform periodic cash inflow, r = discount rate (decimal).",
      "Undiscounted payback = Initial / CF.",
      "Discounted payback (if r is not zero and Initial multiplied by r divided by CF is less than 1): DPP = negative natural log of [1 minus (Initial * r / CF)] divided by natural log of (1 + r).",
      "If CF is less than or equal to zero, or Initial multiplied by r divided by CF is greater than or equal to 1, the formula does not produce a finite positive solution; the calculator reports payback as not achievable and recommends rechecking inputs."
    ],
    "examples": [
      "Example 1: Initial = 10,000, CF = 3,000 per year, r = 8% (0.08). Undiscounted payback = 3.333 years. Discounted payback calculated using the formula above is approximately 3.7 years.",
      "Example 2: If CF = 0 the tool reports payback as not achievable. If r = 0 the discounted payback equals the undiscounted payback."
    ],
    "faqs": [
      {
        "question": "When should I use discounted payback instead of undiscounted payback?",
        "answer": "Use discounted payback when the timing of cash flows matters and when you want to account for the time value of money. Undiscounted payback ignores discounting and can understate true payback time for remote cash flows."
      },
      {
        "question": "Can I use this calculator for irregular or uneven cash flows?",
        "answer": "This particular calculator assumes uniform periodic cash flows. For irregular series, use a dedicated irregular-cash-flow tool that discounts each period individually and computes cumulative discounted cash flows."
      },
      {
        "question": "What does an Infinity result mean?",
        "answer": "Infinity indicates that, under the given parameters, the present value of future cash inflows will never equal the initial investment (for example, cash flow is zero or too small relative to the investment and discount rate)."
      },
      {
        "question": "How should I interpret fractional years?",
        "answer": "Fractional years indicate a partial period required for recovery. They are calculated by solving the discounted cumulative cash flow equation and represent the continuous-time equivalent under the uniform cash flow assumption."
      }
    ],
    "citations": [
      {
        "label": "NIST — Numerical Standards and Good Practices",
        "url": "https://www.nist.gov"
      },
      {
        "label": "ISO — Quality Management Principles (relevant to model validation)",
        "url": "https://www.iso.org"
      },
      {
        "label": "IEEE — Standards and Best Practices for Numerical Computing",
        "url": "https://standards.ieee.org"
      },
      {
        "label": "OSHA — Guidance on Financial Decision Safety and Process Controls",
        "url": "https://www.osha.gov"
      }
    ],
    "glossary": [
      {
        "term": "Discounted payback period (DPP)",
        "definition": "Time required for the sum of discounted cash inflows to equal the initial investment, accounting for the time value of money."
      },
      {
        "term": "Undiscounted payback",
        "definition": "Time required for the sum of nominal (undiscounted) cash inflows to equal the initial investment."
      },
      {
        "term": "Discount rate",
        "definition": "Rate used to convert future cash flows into present value; expressed here as a decimal (for example, 8% = 0.08)."
      }
    ]
  },
  "links": {
    "internal": [
      "/calculators/finance/npv",
      "/calculators/finance/irr",
      "/guides/payback-vs-npv"
    ],
    "external": [
      {
        "url": "https://www.nist.gov",
        "label": "NIST",
        "rel": [
          "noopener",
          "noreferrer"
        ]
      },
      {
        "url": "https://www.iso.org",
        "label": "ISO",
        "rel": [
          "noopener",
          "noreferrer"
        ]
      }
    ]
  },
  "schema": {
    "additionalTypes": [
      "HowTo",
      "FinancialProduct"
    ]
  }
}
