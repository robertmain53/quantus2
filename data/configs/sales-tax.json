{
  "version": "1.0.0",
  "metadata": {
    "title": "Sales Tax Calculator (Advanced)",
    "description": "Multi-mode sales tax calculator for common workflows: calculate tax from subtotal and rate, reverse-calculate tax from a tax-inclusive total, or apply a custom jurisdiction rate. Designed for clarity, explicit rounding, and audit-friendly outputs."
  },
  "logic": {
    "type": "advanced",
    "defaultMethod": "standard_rate",
    "methods": {
      "standard_rate": {
        "label": "Standard calculation (subtotal → tax)",
        "description": "Calculate subtotal, tax amount, and total when you know price, quantity, and the tax rate as a percentage.",
        "variables": {
          "subtotal": {
            "expression": "price * quantity",
            "dependencies": [
              "price",
              "quantity"
            ],
            "label": "Subtotal",
            "unit": "USD",
            "format": "currency",
            "display": true
          },
          "rate_decimal": {
            "expression": "tax_rate / 100",
            "dependencies": [
              "tax_rate"
            ],
            "label": "Tax rate (decimal)",
            "format": "percent",
            "display": false
          },
          "tax_amount": {
            "expression": "subtotal * rate_decimal",
            "dependencies": [
              "subtotal",
              "rate_decimal"
            ],
            "label": "Tax amount",
            "unit": "USD",
            "format": "currency",
            "display": true
          },
          "total": {
            "expression": "subtotal + tax_amount",
            "dependencies": [
              "subtotal",
              "tax_amount"
            ],
            "label": "Total (subtotal + tax)",
            "unit": "USD",
            "format": "currency",
            "display": true
          }
        },
        "outputs": [
          {
            "id": "subtotal",
            "label": "Subtotal",
            "variable": "subtotal",
            "unit": "USD",
            "format": "currency"
          },
          {
            "id": "tax_amount",
            "label": "Tax amount",
            "variable": "tax_amount",
            "unit": "USD",
            "format": "currency"
          },
          {
            "id": "total",
            "label": "Total",
            "variable": "total",
            "unit": "USD",
            "format": "currency"
          }
        ]
      },
      "inclusive_total": {
        "label": "Tax-inclusive total (reverse calculation)",
        "description": "Given a total that already includes tax, derive the pre-tax amount and the tax portion using the provided tax rate percentage.",
        "variables": {
          "rate_decimal": {
            "expression": "tax_rate / 100",
            "dependencies": [
              "tax_rate"
            ],
            "label": "Tax rate (decimal)",
            "format": "percent",
            "display": false
          },
          "pre_tax": {
            "expression": "total_inclusive / (1 + rate_decimal)",
            "dependencies": [
              "total_inclusive",
              "rate_decimal"
            ],
            "label": "Pre-tax amount",
            "unit": "USD",
            "format": "currency",
            "display": true
          },
          "tax_amount": {
            "expression": "total_inclusive - pre_tax",
            "dependencies": [
              "total_inclusive",
              "pre_tax"
            ],
            "label": "Tax amount (from inclusive total)",
            "unit": "USD",
            "format": "currency",
            "display": true
          }
        },
        "outputs": [
          {
            "id": "pre_tax",
            "label": "Pre-tax amount",
            "variable": "pre_tax",
            "unit": "USD",
            "format": "currency"
          },
          {
            "id": "tax_amount",
            "label": "Tax amount",
            "variable": "tax_amount",
            "unit": "USD",
            "format": "currency"
          }
        ]
      },
      "jurisdiction_custom": {
        "label": "Custom jurisdiction rate",
        "description": "Apply a custom jurisdiction rate. Enter the local rate (as a percentage) that applies for the item or location. Use this when you have a verified local combined rate.",
        "variables": {
          "active_rate_decimal": {
            "expression": "lookup_rate / 100",
            "dependencies": [
              "lookup_rate"
            ],
            "label": "Custom tax rate (decimal)",
            "format": "percent",
            "display": false
          },
          "subtotal": {
            "expression": "price * quantity",
            "dependencies": [
              "price",
              "quantity"
            ],
            "label": "Subtotal",
            "unit": "USD",
            "format": "currency",
            "display": true
          },
          "tax_amount": {
            "expression": "subtotal * active_rate_decimal",
            "dependencies": [
              "subtotal",
              "active_rate_decimal"
            ],
            "label": "Tax amount (custom rate)",
            "unit": "USD",
            "format": "currency",
            "display": true
          },
          "total": {
            "expression": "subtotal + tax_amount",
            "dependencies": [
              "subtotal",
              "tax_amount"
            ],
            "label": "Total (subtotal + tax)",
            "unit": "USD",
            "format": "currency",
            "display": true
          }
        },
        "outputs": [
          {
            "id": "subtotal",
            "label": "Subtotal",
            "variable": "subtotal",
            "unit": "USD",
            "format": "currency"
          },
          {
            "id": "tax_amount",
            "label": "Tax amount",
            "variable": "tax_amount",
            "unit": "USD",
            "format": "currency"
          },
          {
            "id": "total",
            "label": "Total",
            "variable": "total",
            "unit": "USD",
            "format": "currency"
          }
        ]
      }
    }
  },
  "form": {
    "fields": [
      {
        "id": "price",
        "label": "Unit price",
        "type": "number",
        "default": 0,
        "min": 0,
        "step": 0.01
      },
      {
        "id": "quantity",
        "label": "Quantity",
        "type": "integer",
        "default": 1,
        "min": 1,
        "step": 1
      },
      {
        "id": "tax_rate",
        "label": "Tax rate (%)",
        "type": "number",
        "default": 8.25,
        "min": 0,
        "max": 100,
        "step": 0.01
      },
      {
        "id": "total_inclusive",
        "label": "Total (tax included)",
        "type": "number",
        "default": 0,
        "min": 0,
        "step": 0.01
      },
      {
        "id": "lookup_rate",
        "label": "Custom jurisdiction combined rate (%)",
        "type": "number",
        "default": 0,
        "min": 0,
        "max": 100,
        "step": 0.01
      },
      {
        "id": "zip",
        "label": "ZIP code (optional, for your record only)",
        "type": "text",
        "default": ""
      }
    ]
  },
  "page_content": {
    "introduction": [
      "This calculator supports three workflows: calculate tax from a subtotal and rate, reverse-calculate tax from a tax-inclusive total, or apply a verified custom jurisdiction rate. It is intended for quick estimates and bookkeeping convenience.",
      "The tool emphasizes transparency: each method returns explicit intermediate values (subtotal, tax amount, pre-tax amount) so you can record how the figure was derived. Always cross-check rates with your jurisdictional tax authority."
    ],
    "methodology": [
      "Numeric computations use standard arithmetic and explicit conversions between percent and decimal forms. Rounding follows common financial practice: round monetary results to two decimal places unless your accounting rules require otherwise.",
      "For software and calculation correctness we follow numeric handling principles consistent with IEEE 754 floating-point guidance and recommend system-level rounding to avoid cumulative floating-point error.",
      "This calculator does not perform jurisdiction lookups automatically. When using a custom jurisdiction rate, enter the combined rate verified from your local tax authority. Tax determination (nexus, product taxability, exemptions) is a legal determination outside the scope of this calculator."
    ],
    "how_is_calculated": [
      "Standard calculation: subtotal = price × quantity",
      "Standard calculation: tax = subtotal × (tax_rate ÷ 100)",
      "Total = subtotal + tax",
      "Reverse (tax-inclusive) calculation: pre_tax = total_inclusive ÷ (1 + tax_rate ÷ 100)",
      "Reverse calculation: tax = total_inclusive − pre_tax"
    ],
    "examples": [
      "Example 1 — Standard: price 20.00, quantity 3, tax rate 8.25 percent produces subtotal 60.00, tax 4.95, total 64.95",
      "Example 2 — Inclusive: total inclusive 107.50 with tax rate 7.5 percent yields pre-tax amount 100.00 and tax 7.50"
    ],
    "faqs": [
      {
        "question": "Can this calculator determine the correct tax rate for my address?",
        "answer": "No. This tool does not perform address-to-rate lookups. Use your jurisdiction's official rate tables or certified rate services to obtain combined state and local rates, then enter that rate here."
      },
      {
        "question": "How are results rounded?",
        "answer": "Monetary outputs should be rounded to two decimal places for reporting. For internal calculations, systems should follow IEEE 754 guidance and use consistent rounding rules to avoid small discrepancies."
      },
      {
        "question": "Does this calculator determine taxability or nexus?",
        "answer": "No. Determinations of whether an item is taxable, or whether you have tax nexus in a jurisdiction, are legal determinations and require review of statute, regulation, or an advisor. This tool only computes amounts from supplied rates."
      },
      {
        "question": "Is this tool compliant with regulatory standards?",
        "answer": "This calculator implements transparent arithmetic and advises practices aligned with numeric standards and quality-management guidance, but it is not a substitute for official tax guidance or certified software for filing."
      },
      {
        "question": "How accurate are results?",
        "answer": "Results are mathematically accurate given the supplied inputs. Accuracy depends on correct rates and inputs. Always verify rates with official sources before reporting or remitting tax."
      }
    ],
    "citations": [
      {
        "label": "IRS guidance on sales tax and deductions",
        "url": "https://www.irs.gov/credits-deductions/individuals/use-the-sales-tax-deduction-calculator"
      },
      {
        "label": "IEEE Standard for Floating-Point Arithmetic (IEEE 754)",
        "url": "https://standards.ieee.org/standard/754-2019.html"
      },
      {
        "label": "NIST — general standards and measurement traceability",
        "url": "https://www.nist.gov"
      },
      {
        "label": "ISO 9001 — Quality management systems",
        "url": "https://www.iso.org/iso-9001-quality-management.html"
      },
      {
        "label": "OSHA — guidance on workplace practices (organizational quality and safety context)",
        "url": "https://www.osha.gov"
      }
    ],
    "glossary": [
      {
        "term": "Tax rate (combined)",
        "definition": "The total percentage applied to a taxable base, including state, county, city, and special district rates when applicable."
      },
      {
        "term": "Taxable nexus",
        "definition": "A legal connection between a taxpayer and a jurisdiction that obligates the taxpayer to collect or remit that jurisdiction's sales tax."
      },
      {
        "term": "Tax-exclusive price",
        "definition": "A price stated before tax is added. The tax is computed and added to reach the final total."
      },
      {
        "term": "Tax-inclusive price",
        "definition": "A total price that already includes tax. Reverse calculation is used to determine the pre-tax base and tax portion."
      },
      {
        "term": "Rounding rule",
        "definition": "The policy used to round monetary results. Common practice is round half away from zero to two decimal places for currency."
      }
    ]
  },
  "links": {
    "external": [
      {
        "url": "https://www.irs.gov/credits-deductions/individuals/use-the-sales-tax-deduction-calculator",
        "label": "IRS: Sales tax deduction calculator (guidance)",
        "rel": [
          "noopener",
          "noreferrer"
        ]
      },
      {
        "url": "https://standards.ieee.org/standard/754-2019.html",
        "label": "IEEE 754 floating-point standard",
        "rel": [
          "noopener",
          "noreferrer"
        ]
      },
      {
        "url": "https://www.iso.org/iso-9001-quality-management.html",
        "label": "ISO 9001 quality management guidance",
        "rel": [
          "noopener",
          "noreferrer"
        ]
      }
    ]
  },
  "schema": {
    "additionalTypes": [
      "HowTo"
    ]
  }
}
