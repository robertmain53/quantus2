{
  "version": "1.0.0",
  "metadata": {
    "title": "Student Loan Adjustable-Rate Calculator (Advanced)",
    "description": "Estimate payments for adjustable-rate student loans including hybrid fixed-then-adjustable scenarios, fully variable loans, and a fixed-only comparison. Includes caps, margins, index inputs, and clear accuracy and compliance notes."
  },
  "logic": {
    "type": "advanced",
    "defaultMethod": "hybrid_fixed_then_adjustable",
    "methods": {
      "hybrid_fixed_then_adjustable": {
        "label": "Fixed period then adjustable (common student loan ARMs)",
        "description": "Initial fixed-rate period followed by rate adjustments at each adjustment interval. Adjusted rate is index + margin and is limited by per-adjustment caps and a lifetime cap.",
        "variables": {
          "initial_rate": {
            "expression": "initial_rate_pct / 100",
            "dependencies": [
              "initial_rate_pct"
            ],
            "label": "Initial interest rate (decimal)",
            "format": "decimal",
            "display": true
          },
          "monthly_rate_initial": {
            "expression": "initial_rate / payments_per_year",
            "dependencies": [
              "initial_rate",
              "payments_per_year"
            ],
            "label": "Initial periodic rate",
            "format": "decimal",
            "display": false
          },
          "n_total_payments": {
            "expression": "loan_term_years * payments_per_year",
            "dependencies": [
              "loan_term_years",
              "payments_per_year"
            ],
            "label": "Total number of payments",
            "format": "integer",
            "display": false
          },
          "n_payments_fixed": {
            "expression": "initial_fixed_period_years * payments_per_year",
            "dependencies": [
              "initial_fixed_period_years",
              "payments_per_year"
            ],
            "label": "Number of payments in fixed period",
            "format": "integer",
            "display": false
          },
          "monthly_payment_initial": {
            "expression": "principal * monthly_rate_initial / (1 - pow(1 + monthly_rate_initial, -n_total_payments))",
            "dependencies": [
              "principal",
              "monthly_rate_initial",
              "n_total_payments"
            ],
            "label": "Estimated monthly payment during initial fixed period",
            "unit": "USD",
            "format": "currency",
            "display": true
          },
          "raw_new_rate_pct": {
            "expression": "index_rate_pct + margin_pct",
            "dependencies": [
              "index_rate_pct",
              "margin_pct"
            ],
            "label": "Index + margin (percent)",
            "format": "percent",
            "display": false
          },
          "capped_new_rate_pct": {
            "expression": "min(raw_new_rate_pct, initial_rate_pct + cap_per_adjustment_pct, initial_rate_pct + lifetime_cap_pct)",
            "dependencies": [
              "raw_new_rate_pct",
              "initial_rate_pct",
              "cap_per_adjustment_pct",
              "lifetime_cap_pct"
            ],
            "label": "Adjusted rate after caps (percent)",
            "format": "percent",
            "display": true
          },
          "monthly_rate_new": {
            "expression": "(capped_new_rate_pct / 100) / payments_per_year",
            "dependencies": [
              "capped_new_rate_pct",
              "payments_per_year"
            ],
            "label": "Periodic rate after adjustment",
            "format": "decimal",
            "display": false
          },
          "remaining_payments": {
            "expression": "n_total_payments - n_payments_fixed",
            "dependencies": [
              "n_total_payments",
              "n_payments_fixed"
            ],
            "label": "Remaining payments after fixed period",
            "format": "integer",
            "display": false
          },
          "monthly_payment_after_adjustment": {
            "expression": "principal * monthly_rate_new / (1 - pow(1 + monthly_rate_new, -remaining_payments))",
            "dependencies": [
              "principal",
              "monthly_rate_new",
              "remaining_payments"
            ],
            "label": "Estimated monthly payment after first adjustment",
            "unit": "USD",
            "format": "currency",
            "display": true
          }
        },
        "outputs": [
          {
            "id": "first_month_payment",
            "label": "Estimated first-month payment (fixed period)",
            "variable": "monthly_payment_initial",
            "unit": "USD",
            "format": "currency"
          },
          {
            "id": "payment_after_first_adjustment",
            "label": "Estimated payment after first adjustment",
            "variable": "monthly_payment_after_adjustment",
            "unit": "USD",
            "format": "currency"
          },
          {
            "id": "adjusted_rate_percent",
            "label": "Adjusted rate after caps (percent)",
            "variable": "capped_new_rate_pct",
            "unit": "%",
            "format": "percent"
          },
          {
            "id": "remaining_payments",
            "label": "Remaining payments after fixed period",
            "variable": "remaining_payments",
            "format": "integer"
          }
        ]
      },
      "fully_variable": {
        "label": "Fully variable loan (rate can change from the start)",
        "description": "Rate is based on index + margin and may change at each adjustment period. Caps (per-adjustment and lifetime) limit increases where applicable.",
        "variables": {
          "raw_rate_pct": {
            "expression": "index_rate_pct + margin_pct",
            "dependencies": [
              "index_rate_pct",
              "margin_pct"
            ],
            "label": "Index + margin (percent)",
            "format": "percent",
            "display": false
          },
          "capped_rate_pct": {
            "expression": "min(raw_rate_pct, initial_rate_pct + cap_per_adjustment_pct, initial_rate_pct + lifetime_cap_pct)",
            "dependencies": [
              "raw_rate_pct",
              "initial_rate_pct",
              "cap_per_adjustment_pct",
              "lifetime_cap_pct"
            ],
            "label": "Initial adjusted rate after caps (percent)",
            "format": "percent",
            "display": true
          },
          "monthly_rate_var": {
            "expression": "(capped_rate_pct / 100) / payments_per_year",
            "dependencies": [
              "capped_rate_pct",
              "payments_per_year"
            ],
            "label": "Periodic rate (variable)",
            "format": "decimal",
            "display": false
          },
          "n_total_payments": {
            "expression": "loan_term_years * payments_per_year",
            "dependencies": [
              "loan_term_years",
              "payments_per_year"
            ],
            "label": "Total number of payments",
            "format": "integer",
            "display": false
          },
          "monthly_payment_variable": {
            "expression": "principal * monthly_rate_var / (1 - pow(1 + monthly_rate_var, -n_total_payments))",
            "dependencies": [
              "principal",
              "monthly_rate_var",
              "n_total_payments"
            ],
            "label": "Estimated monthly payment (variable-rate calculation)",
            "unit": "USD",
            "format": "currency",
            "display": true
          }
        },
        "outputs": [
          {
            "id": "variable_first_payment",
            "label": "Estimated first payment (variable loan)",
            "variable": "monthly_payment_variable",
            "unit": "USD",
            "format": "currency"
          },
          {
            "id": "variable_rate_percent",
            "label": "Initial adjusted rate (percent)",
            "variable": "capped_rate_pct",
            "unit": "%",
            "format": "percent"
          }
        ]
      },
      "fixed_only": {
        "label": "Fixed-rate only (comparison)",
        "description": "Fixed interest rate for the life of the loan. Useful as a baseline comparison against adjustable scenarios.",
        "variables": {
          "fixed_rate": {
            "expression": "initial_rate_pct / 100",
            "dependencies": [
              "initial_rate_pct"
            ],
            "label": "Fixed annual rate (decimal)",
            "format": "decimal",
            "display": false
          },
          "monthly_fixed_rate": {
            "expression": "fixed_rate / payments_per_year",
            "dependencies": [
              "fixed_rate",
              "payments_per_year"
            ],
            "label": "Fixed periodic rate",
            "format": "decimal",
            "display": false
          },
          "n_total_payments": {
            "expression": "loan_term_years * payments_per_year",
            "dependencies": [
              "loan_term_years",
              "payments_per_year"
            ],
            "label": "Total number of payments",
            "format": "integer",
            "display": false
          },
          "monthly_payment_fixed": {
            "expression": "principal * monthly_fixed_rate / (1 - pow(1 + monthly_fixed_rate, -n_total_payments))",
            "dependencies": [
              "principal",
              "monthly_fixed_rate",
              "n_total_payments"
            ],
            "label": "Monthly payment (fixed-rate)",
            "unit": "USD",
            "format": "currency",
            "display": true
          }
        },
        "outputs": [
          {
            "id": "fixed_monthly_payment",
            "label": "Monthly payment (fixed-rate)",
            "variable": "monthly_payment_fixed",
            "unit": "USD",
            "format": "currency"
          }
        ]
      }
    }
  },
  "form": {
    "fields": [
      {
        "id": "principal",
        "label": "Loan principal (total balance)",
        "type": "number",
        "default": 20000,
        "min": 0,
        "step": 100
      },
      {
        "id": "loan_term_years",
        "label": "Loan term (years)",
        "type": "integer",
        "default": 10,
        "min": 1,
        "max": 50,
        "step": 1
      },
      {
        "id": "initial_rate_pct",
        "label": "Initial interest rate (annual %, nominal)",
        "type": "number",
        "default": 5,
        "min": 0,
        "max": 100,
        "step": 0.01
      },
      {
        "id": "index_rate_pct",
        "label": "Current index rate (annual %, e.g., LIBOR, SOFR equivalent)",
        "type": "number",
        "default": 3,
        "min": -10,
        "max": 100,
        "step": 0.01
      },
      {
        "id": "margin_pct",
        "label": "Lender margin (percentage points)",
        "type": "number",
        "default": 2,
        "min": 0,
        "max": 50,
        "step": 0.01
      },
      {
        "id": "adjustment_frequency_years",
        "label": "Adjustment frequency (years between rate changes)",
        "type": "integer",
        "default": 1,
        "min": 1,
        "max": 5,
        "step": 1
      },
      {
        "id": "cap_per_adjustment_pct",
        "label": "Per-adjustment cap (maximum percentage point change at each adjustment)",
        "type": "number",
        "default": 2,
        "min": 0,
        "max": 100,
        "step": 0.01
      },
      {
        "id": "lifetime_cap_pct",
        "label": "Lifetime cap (maximum percentage points above the initial rate)",
        "type": "number",
        "default": 6,
        "min": 0,
        "max": 100,
        "step": 0.01
      },
      {
        "id": "initial_fixed_period_years",
        "label": "Initial fixed period (years; set to 0 for no fixed period)",
        "type": "integer",
        "default": 5,
        "min": 0,
        "max": 30,
        "step": 1
      },
      {
        "id": "payments_per_year",
        "label": "Payments per year",
        "type": "integer",
        "default": 12,
        "min": 1,
        "max": 12,
        "step": 1
      }
    ]
  },
  "page_content": {
    "introduction": [
      "This calculator estimates monthly payments for adjustable-rate student loans and provides a fixed-rate comparison. It supports hybrid fixed-then-adjustable structures (common in private student loans) and fully variable loans. Use the inputs to model how index changes, margin, and caps affect payments.",
      "Results are estimates intended to help with planning. They are not loan offers and do not replace official disclosures or lender-provided amortization schedules."
    ],
    "methodology": [
      "Payment calculations use standard amortizing loan formulas: periodic rate r, number of payments n, and the annuity formula Payment = r * P / (1 - (1+r)^-n) to compute level payments for a given rate and remaining term.",
      "Adjusted rates are modeled as index + margin, then limited by a per-adjustment cap and a lifetime cap. The calculator computes the first adjusted payment assuming recalculation at the first scheduled adjustment and full amortization over the remaining term.",
      "Numerical and data-handling practices align with recognized guidance for accuracy and traceability, including NIST best practices for numerical computations and data integrity, ISO quality management principles, and IEEE recommendations for floating-point considerations. See accuracy and caveats below."
    ],
    "how_is_calculated": [
      "Convert percentage inputs to decimals by dividing by 100 for rate computations.",
      "Periodic rate r = annual_rate_decimal / payments_per_year.",
      "Monthly payment (amortizing) = r * principal / (1 - (1 + r)^-n) where n is the number of remaining periodic payments.",
      "Adjusted rate after caps = min(index + margin, initial rate + per-adjustment cap, initial rate + lifetime cap).",
      "For hybrid loans, the initial payment is computed using the initial rate for the full term as a baseline; the post-adjustment payment is recomputed using the capped adjusted rate amortized over the remaining term."
    ],
    "faqs": [
      {
        "question": "Is this an official payoff or payoff schedule?",
        "answer": "No. This tool provides estimates only. Official payoff amounts, exact amortization schedules, and borrower rights are provided by your loan servicer and loan agreement. Use this as a planning aid."
      },
      {
        "question": "Which index should I use for the index rate input?",
        "answer": "Use the published index referenced in your loan contract (for example SOFR, a published treasury rate, or another named index). If unsure, consult your loan documents or servicer."
      },
      {
        "question": "How do caps affect my payments?",
        "answer": "Caps limit how much the interest rate can rise at each adjustment and over the life of the loan. This calculator applies both per-adjustment and lifetime caps when computing adjusted rates."
      },
      {
        "question": "How accurate are these numbers?",
        "answer": "Calculations follow standard amortization formulas and cap logic, but they are subject to rounding, timing differences, exact index publication lags, and servicer-specific rules (e.g., negative amortization options, minimum payment floors). See the accuracy and standards citations for more information."
      }
    ],
    "citations": [
      {
        "label": "National Institute of Standards and Technology (NIST)",
        "url": "https://www.nist.gov"
      },
      {
        "label": "International Organization for Standardization (ISO)",
        "url": "https://www.iso.org"
      },
      {
        "label": "Institute of Electrical and Electronics Engineers (IEEE)",
        "url": "https://www.ieee.org"
      },
      {
        "label": "Occupational Safety and Health Administration (OSHA) — general safety and quality references",
        "url": "https://www.osha.gov"
      },
      {
        "label": "Consumer Financial Protection Bureau — student loans",
        "url": "https://www.consumerfinance.gov"
      }
    ],
    "glossary": [
      {
        "term": "Index",
        "definition": "A published rate (for example SOFR or a treasury-based index) that, plus the lender's margin, determines the variable interest rate."
      },
      {
        "term": "Margin",
        "definition": "A fixed percentage points amount added to the index by the lender to determine the borrower's rate."
      },
      {
        "term": "Per-adjustment cap",
        "definition": "The maximum number of percentage points the interest rate can increase or decrease at any one scheduled adjustment."
      },
      {
        "term": "Lifetime cap",
        "definition": "The maximum increase in percentage points above the initial rate allowed over the life of the loan."
      },
      {
        "term": "Amortization",
        "definition": "The process of paying off debt with periodic payments that cover interest and principal such that the loan balance reaches zero at the end of the term."
      }
    ],
    "summary": [
      "This advanced calculator models common adjustable-rate student loan structures and provides comparable fixed-rate estimates.",
      "Use indexed rate inputs that match your loan agreement and treat results as planning estimates. Confirm exact terms, schedules, and legal notices with your lender or servicer."
    ]
  },
  "links": {
    "internal": [],
    "external": [
      {
        "url": "https://www.nist.gov",
        "label": "NIST official site",
        "rel": [
          "noopener",
          "noreferrer"
        ]
      },
      {
        "url": "https://www.iso.org",
        "label": "ISO official site",
        "rel": [
          "noopener",
          "noreferrer"
        ]
      },
      {
        "url": "https://www.ieee.org",
        "label": "IEEE official site",
        "rel": [
          "noopener",
          "noreferrer"
        ]
      },
      {
        "url": "https://www.consumerfinance.gov",
        "label": "Consumer Financial Protection Bureau",
        "rel": [
          "noopener",
          "noreferrer"
        ]
      }
    ]
  },
  "schema": {
    "additionalTypes": [
      "HowTo"
    ]
  }
}