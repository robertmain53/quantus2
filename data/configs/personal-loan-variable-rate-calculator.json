{
  "version": "1.0.0",
  "metadata": {
    "title": "Personal Loan — Variable Rate Calculator",
    "description": "Estimate payments and rate adjustments for variable-rate personal loans. Supports amortizing and interest-only schedules, adjustable-rate mechanics (index + margin), periodic and lifetime caps, and side-by-side comparison with a fixed-rate alternative."
  },
  "logic": {
    "type": "advanced",
    "defaultMethod": "variable_amortizing",
    "methods": {
      "variable_amortizing": {
        "label": "Amortizing variable-rate loan",
        "description": "Standard amortizing loan where payments are calculated on the projected interest rate after applying index, margin, periodic cap, and lifetime cap.",
        "variables": {
          "payments_total": {
            "expression": "term_years * payments_per_year",
            "dependencies": [
              "term_years",
              "payments_per_year"
            ],
            "label": "Total number of payments",
            "unit": "payments",
            "format": "integer",
            "display": true
          },
          "starting_rate": {
            "expression": "initial_rate_percent / 100",
            "dependencies": [
              "initial_rate_percent"
            ],
            "label": "Starting APR (decimal)",
            "unit": "",
            "format": "percent",
            "display": false
          },
          "index_plus_margin": {
            "expression": "(index_rate_percent + margin_percent) / 100",
            "dependencies": [
              "index_rate_percent",
              "margin_percent"
            ],
            "label": "Index + margin (decimal)",
            "unit": "",
            "format": "percent",
            "display": false
          },
          "uncapped_next_rate": {
            "expression": "index_plus_margin",
            "dependencies": [
              "index_plus_margin"
            ],
            "label": "Uncapped next rate (decimal)",
            "unit": "",
            "format": "percent",
            "display": false
          },
          "periodic_limited_rate": {
            "expression": "min( max(uncapped_next_rate, starting_rate - (periodic_cap_percent / 100)), starting_rate + (periodic_cap_percent / 100) )",
            "dependencies": [
              "uncapped_next_rate",
              "starting_rate",
              "periodic_cap_percent"
            ],
            "label": "Rate after applying periodic cap (decimal)",
            "unit": "",
            "format": "percent",
            "display": false
          },
          "lifetime_limited_rate": {
            "expression": "min( max(periodic_limited_rate, starting_rate - (lifetime_cap_percent / 100)), starting_rate + (lifetime_cap_percent / 100) )",
            "dependencies": [
              "periodic_limited_rate",
              "starting_rate",
              "lifetime_cap_percent"
            ],
            "label": "Rate after applying lifetime cap (decimal)",
            "unit": "",
            "format": "percent",
            "display": true
          },
          "periodic_rate_per_payment": {
            "expression": "lifetime_limited_rate / payments_per_year",
            "dependencies": [
              "lifetime_limited_rate",
              "payments_per_year"
            ],
            "label": "Periodic interest rate per payment",
            "unit": "",
            "format": "percent",
            "display": false
          },
          "periodic_payment": {
            "expression": "if( lifetime_limited_rate == 0, principal / payments_total, principal * (periodic_rate_per_payment) / (1 - (1 + periodic_rate_per_payment) ^ (-payments_total)) )",
            "dependencies": [
              "principal",
              "periodic_rate_per_payment",
              "payments_total",
              "lifetime_limited_rate"
            ],
            "label": "Estimated payment per period",
            "unit": "",
            "format": "currency",
            "display": true
          }
        },
        "outputs": [
          {
            "id": "periodic_payment",
            "label": "Payment per period",
            "variable": "periodic_payment",
            "unit": "",
            "format": "currency"
          },
          {
            "id": "lifetime_limited_rate",
            "label": "Projected post-adjustment APR",
            "variable": "lifetime_limited_rate",
            "unit": "%",
            "format": "percent"
          },
          {
            "id": "payments_total",
            "label": "Total payments",
            "variable": "payments_total",
            "unit": "payments",
            "format": "integer"
          }
        ]
      },
      "interest_only_variable": {
        "label": "Interest-only then amortizing variable-rate loan",
        "description": "Loan with an interest-only initial period followed by amortizing payments for the remaining term. Interest payments during IO period are calculated at the capped adjusted rate.",
        "variables": {
          "payments_total": {
            "expression": "term_years * payments_per_year",
            "dependencies": [
              "term_years",
              "payments_per_year"
            ],
            "label": "Total number of payments",
            "unit": "payments",
            "format": "integer",
            "display": false
          },
          "io_payments": {
            "expression": "ceil( interest_only_period_months / (12 / payments_per_year) )",
            "dependencies": [
              "interest_only_period_months",
              "payments_per_year"
            ],
            "label": "Number of interest-only payments",
            "unit": "payments",
            "format": "integer",
            "display": false
          },
          "starting_rate": {
            "expression": "initial_rate_percent / 100",
            "dependencies": [
              "initial_rate_percent"
            ],
            "label": "Starting APR (decimal)",
            "unit": "",
            "format": "percent",
            "display": false
          },
          "index_plus_margin": {
            "expression": "(index_rate_percent + margin_percent) / 100",
            "dependencies": [
              "index_rate_percent",
              "margin_percent"
            ],
            "label": "Index + margin (decimal)",
            "unit": "",
            "format": "percent",
            "display": false
          },
          "periodic_limited_rate": {
            "expression": "min( max(index_plus_margin, starting_rate - (periodic_cap_percent / 100)), starting_rate + (periodic_cap_percent / 100) )",
            "dependencies": [
              "index_plus_margin",
              "starting_rate",
              "periodic_cap_percent"
            ],
            "label": "Rate after periodic cap (decimal)",
            "unit": "",
            "format": "percent",
            "display": false
          },
          "lifetime_limited_rate": {
            "expression": "min( max(periodic_limited_rate, starting_rate - (lifetime_cap_percent / 100)), starting_rate + (lifetime_cap_percent / 100) )",
            "dependencies": [
              "periodic_limited_rate",
              "starting_rate",
              "lifetime_cap_percent"
            ],
            "label": "Rate after lifetime cap (decimal)",
            "unit": "",
            "format": "percent",
            "display": true
          },
          "io_payment": {
            "expression": "principal * (lifetime_limited_rate / payments_per_year)",
            "dependencies": [
              "principal",
              "lifetime_limited_rate",
              "payments_per_year"
            ],
            "label": "Interest-only payment",
            "unit": "",
            "format": "currency",
            "display": true
          },
          "remaining_payments": {
            "expression": "payments_total - io_payments",
            "dependencies": [
              "payments_total",
              "io_payments"
            ],
            "label": "Payments after IO period",
            "unit": "payments",
            "format": "integer",
            "display": false
          },
          "post_io_rate_per_payment": {
            "expression": "lifetime_limited_rate / payments_per_year",
            "dependencies": [
              "lifetime_limited_rate",
              "payments_per_year"
            ],
            "label": "Periodic interest rate after IO",
            "unit": "",
            "format": "percent",
            "display": false
          },
          "post_io_payment": {
            "expression": "if( post_io_rate_per_payment == 0, principal / remaining_payments, principal * (post_io_rate_per_payment) / (1 - (1 + post_io_rate_per_payment) ^ (-remaining_payments)) )",
            "dependencies": [
              "principal",
              "post_io_rate_per_payment",
              "remaining_payments"
            ],
            "label": "Amortizing payment after IO period",
            "unit": "",
            "format": "currency",
            "display": true
          }
        },
        "outputs": [
          {
            "id": "io_payment",
            "label": "Interest-only payment",
            "variable": "io_payment",
            "unit": "",
            "format": "currency"
          },
          {
            "id": "post_io_payment",
            "label": "Payment after IO period",
            "variable": "post_io_payment",
            "unit": "",
            "format": "currency"
          },
          {
            "id": "lifetime_limited_rate",
            "label": "Projected post-adjustment APR",
            "variable": "lifetime_limited_rate",
            "unit": "%",
            "format": "percent"
          }
        ]
      },
      "fixed_comparison": {
        "label": "Fixed-rate comparison",
        "description": "Compute fixed-rate payment for the same principal and term to compare with variable scenarios.",
        "variables": {
          "payments_total": {
            "expression": "term_years * payments_per_year",
            "dependencies": [
              "term_years",
              "payments_per_year"
            ],
            "label": "Total number of payments",
            "unit": "payments",
            "format": "integer",
            "display": false
          },
          "fixed_rate_decimal": {
            "expression": "fixed_rate_percent / 100",
            "dependencies": [
              "fixed_rate_percent"
            ],
            "label": "Fixed APR (decimal)",
            "unit": "",
            "format": "percent",
            "display": false
          },
          "fixed_rate_per_payment": {
            "expression": "fixed_rate_decimal / payments_per_year",
            "dependencies": [
              "fixed_rate_decimal",
              "payments_per_year"
            ],
            "label": "Fixed periodic rate",
            "unit": "",
            "format": "percent",
            "display": false
          },
          "fixed_payment": {
            "expression": "if( fixed_rate_per_payment == 0, principal / payments_total, principal * (fixed_rate_per_payment) / (1 - (1 + fixed_rate_per_payment) ^ (-payments_total)) )",
            "dependencies": [
              "principal",
              "fixed_rate_per_payment",
              "payments_total"
            ],
            "label": "Fixed-rate payment per period",
            "unit": "",
            "format": "currency",
            "display": true
          }
        },
        "outputs": [
          {
            "id": "fixed_payment",
            "label": "Fixed-rate payment",
            "variable": "fixed_payment",
            "unit": "",
            "format": "currency"
          }
        ]
      }
    }
  },
  "form": {
    "fields": [
      {
        "id": "principal",
        "label": "Loan amount",
        "type": "number",
        "default": 10000,
        "min": 100,
        "step": 100
      },
      {
        "id": "term_years",
        "label": "Total loan term (years)",
        "type": "integer",
        "default": 5,
        "min": 1,
        "max": 30,
        "step": 1
      },
      {
        "id": "payments_per_year",
        "label": "Payments per year",
        "type": "integer",
        "default": 12,
        "min": 1,
        "max": 12,
        "step": 1
      },
      {
        "id": "initial_rate_percent",
        "label": "Current APR (%)",
        "type": "number",
        "default": 7.5,
        "min": 0,
        "step": 0.01
      },
      {
        "id": "index_rate_percent",
        "label": "Current index rate (%) (e.g., prime, LIBOR, SOFR)",
        "type": "number",
        "default": 3.0,
        "min": 0,
        "step": 0.01
      },
      {
        "id": "margin_percent",
        "label": "Lender margin (%)",
        "type": "number",
        "default": 4.5,
        "min": 0,
        "step": 0.01
      },
      {
        "id": "periodic_cap_percent",
        "label": "Periodic adjustment cap (%) per change",
        "type": "number",
        "default": 2.0,
        "min": 0,
        "step": 0.01
      },
      {
        "id": "lifetime_cap_percent",
        "label": "Lifetime cap (%) above or below the initial rate",
        "type": "number",
        "default": 6.0,
        "min": 0,
        "step": 0.01
      },
      {
        "id": "adjustment_period_months",
        "label": "Rate adjustment period (months)",
        "type": "integer",
        "default": 12,
        "min": 1,
        "max": 120,
        "step": 1
      },
      {
        "id": "initial_fixed_period_months",
        "label": "Initial fixed-rate period (months) before adjustments",
        "type": "integer",
        "default": 0,
        "min": 0,
        "step": 1
      },
      {
        "id": "payment_type",
        "label": "Payment type",
        "type": "select",
        "default": "amortizing",
        "options": [
          {
            "label": "Amortizing",
            "value": "amortizing"
          },
          {
            "label": "Interest-only then amortizing",
            "value": "interest_only"
          }
        ]
      },
      {
        "id": "interest_only_period_months",
        "label": "Interest-only period (months)",
        "type": "integer",
        "default": 12,
        "min": 0,
        "step": 1
      },
      {
        "id": "fixed_rate_percent",
        "label": "Fixed-rate APR to compare (%)",
        "type": "number",
        "default": 6.5,
        "min": 0,
        "step": 0.01
      }
    ],
    "sections": [
      {
        "id": "io_section",
        "label": "Interest-only options",
        "show_when": {
          "field": "payment_type",
          "is": "interest_only"
        },
        "fields": [
          {
            "id": "interest_only_period_months",
            "label": "Interest-only period (months)",
            "type": "integer",
            "default": 12,
            "min": 1,
            "step": 1
          }
        ]
      }
    ],
    "result": {
      "outputs": [
        {
          "id": "periodic_payment",
          "label": "Estimated payment (amortizing)"
        },
        {
          "id": "lifetime_limited_rate",
          "label": "Projected APR after adjustment"
        },
        {
          "id": "io_payment",
          "label": "Interest-only payment"
        },
        {
          "id": "post_io_payment",
          "label": "Payment after IO period"
        },
        {
          "id": "fixed_payment",
          "label": "Fixed-rate payment (comparison)"
        }
      ]
    }
  },
  "page_content": {
    "introduction": [
      "This calculator helps you estimate how a personal loan with a variable interest rate may behave when the index changes. It models typical adjustable-rate mechanics: index + margin, periodic adjustment limits, lifetime caps, optional initial fixed periods, and interest-only options.",
      "Use the results for planning and comparison. Outputs are estimates based on the inputs and modeling assumptions. They do not replace lender disclosures or legally binding loan documents."
    ],
    "methodology": [
      "Rates are modeled as index + margin. After an adjustment, the uncapped new rate is computed as index + margin. Periodic caps and lifetime caps are applied in sequence to limit changes. Periodic caps restrict movement per adjustment; lifetime caps limit total change versus the starting rate.",
      "Payments for amortizing schedules use standard installment math: payment = P * r / (1 - (1+r)^-n). Interest-only payments are calculated as principal * (periodic rate). This tool assumes compounding aligned with the payment frequency.",
      "Modeling and controls adhere to secure development and data integrity practices recommended by NIST SP 800-series for input validation and by ISO/IEC software quality standards for transparency. Results are informational and should be checked against official loan statements."
    ],
    "how_is_calculated": [
      "Uncapped adjusted APR = index rate (%) + margin (%)",
      "Rate after periodic cap = limit the change from the starting APR to +/- periodic cap (%) per adjustment",
      "Rate after lifetime cap = further limit the adjusted rate to be within starting APR +/- lifetime cap (%)",
      "Periodic payment (amortizing) = P * r / (1 - (1 + r)^-n) where r = APR per payment period and n = total payments",
      "Interest-only payment = Principal * (APR per payment period)"
    ],
    "examples": [
      "Example 1: $10,000 principal, 5-year term, monthly payments, starting APR 7.5%, index 3.0%, margin 4.5%, periodic cap 2%, lifetime cap 6% → tool returns projected APR after cap and estimated monthly payment.",
      "Example 2: Interest-only option for first 12 months: tool returns the lower IO payment during the IO period and the higher amortizing payment once principal amortization begins."
    ],
    "faqs": [
      {
        "question": "Is this calculation guaranteed to match my lender's statement?",
        "answer": "No. This tool provides an estimate based on input assumptions and a generalized cap model. Lender-specific adjustments, rounding rules, fee structures, and contract language may produce different results. Always consult your lender's periodic rate notices and the loan agreement."
      },
      {
        "question": "What is an index and how often does it change?",
        "answer": "An index is a published benchmark interest rate (for example, a policy rate or overnight rate). Frequency of change depends on the index and your loan contract. This calculator accepts an index rate input for the next adjustment and applies caps according to your inputs."
      },
      {
        "question": "How should I use the periodic and lifetime cap fields?",
        "answer": "Periodic cap limits how much the rate may change at a single adjustment. Lifetime cap limits the total deviation from the initial APR across the loan's life. Enter the percentage caps as stated in your loan documents."
      },
      {
        "question": "Are regulatory and security standards considered?",
        "answer": "Yes. Development and input validation recommendations reference NIST and ISO guidelines. This tool does not provide legal or financial advice and is for planning only."
      }
    ],
    "citations": [
      {
        "label": "NIST Computer Security Resource Center",
        "url": "https://csrc.nist.gov"
      },
      {
        "label": "ISO Standards Portal",
        "url": "https://www.iso.org"
      },
      {
        "label": "IEEE Standards Association",
        "url": "https://standards.ieee.org"
      },
      {
        "label": "Consumer financial protection guidance",
        "url": "https://www.consumerfinance.gov"
      }
    ],
    "glossary": [
      {
        "term": "Index",
        "definition": "A published benchmark rate used to calculate an adjustable interest rate (e.g., prime rate, SOFR)."
      },
      {
        "term": "Margin",
        "definition": "A fixed percentage a lender adds to the index to determine the loan's APR."
      },
      {
        "term": "Periodic cap",
        "definition": "Maximum percentage the APR may change at a single adjustment period."
      },
      {
        "term": "Lifetime cap",
        "definition": "Maximum total percentage the APR may differ from the initial APR over the loan's life."
      },
      {
        "term": "Amortizing payment",
        "definition": "Periodic payment that covers interest and reduces principal so the loan is fully paid at term end."
      },
      {
        "term": "Interest-only payment",
        "definition": "Payment covering only interest; principal is unchanged during the interest-only period."
      }
    ]
  },
  "links": {
    "internal": [
      "/loans/personal/variablerate-explainer",
      "/loans/personal/compare-fixed-vs-variable"
    ],
    "external": [
      {
        "url": "https://csrc.nist.gov",
        "label": "NIST CSRC",
        "rel": [
          "noopener",
          "noreferrer"
        ]
      },
      {
        "url": "https://www.iso.org/standards.html",
        "label": "ISO Standards",
        "rel": [
          "noopener",
          "noreferrer"
        ]
      }
    ]
  },
  "schema": {
    "additionalTypes": [
      "HowTo"
    ]
  }
}