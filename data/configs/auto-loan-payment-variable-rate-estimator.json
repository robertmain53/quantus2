{
  "version": "1.0.0",
  "metadata": {
    "title": "Auto Loan Payment — Variable Rate Estimator",
    "description": "Estimate scheduled payments and key metrics for adjustable-rate auto loans. Supports index+margin ARMs, fixed-rate comparisons, and basic cap/floor rules. Includes calibration notes, limits, and accuracy caveats aligned with recognized engineering and security standards."
  },
  "logic": {
    "type": "advanced",
    "defaultMethod": "variable_index_margin",
    "methods": {
      "variable_index_margin": {
        "label": "Index + Margin (variable-rate) with basic caps/floor",
        "description": "Calculates amortizing payment using the current index plus margin, applies basic periodic and lifetime caps and a floor for displayed initial reset. Assumes resets change the scheduled interest used for subsequent payments; this method returns the initial scheduled payment and key rate metrics for the next reset window.",
        "variables": {
          "rate_decimal": {
            "expression": "(index_rate_percent_current + margin_percent) / 100",
            "dependencies": [
              "index_rate_percent_current",
              "margin_percent"
            ],
            "label": "Current nominal annual rate (decimal)",
            "unit": "",
            "format": "decimal",
            "display": true
          },
          "periodic_rate": {
            "expression": "rate_decimal / payments_per_year",
            "dependencies": [
              "rate_decimal",
              "payments_per_year"
            ],
            "label": "Periodic rate per payment",
            "unit": "",
            "format": "decimal",
            "display": true
          },
          "n_periods": {
            "expression": "term_months * payments_per_year / 12",
            "dependencies": [
              "term_months",
              "payments_per_year"
            ],
            "label": "Total number of payments",
            "unit": "",
            "format": "integer",
            "display": true
          },
          "periodic_factor": {
            "expression": "pow(1 + periodic_rate, n_periods)",
            "dependencies": [
              "periodic_rate",
              "n_periods"
            ],
            "label": "Discount factor (1+periodic_rate)^n",
            "unit": "",
            "format": "decimal",
            "display": false
          },
          "initial_payment": {
            "expression": "loan_amount * periodic_rate * periodic_factor / (periodic_factor - 1)",
            "dependencies": [
              "loan_amount",
              "periodic_rate",
              "periodic_factor"
            ],
            "label": "Scheduled payment per period (initial)",
            "unit": "USD",
            "format": "currency",
            "display": true
          },
          "uncapped_rate_percent": {
            "expression": "(index_rate_percent_current + margin_percent)",
            "dependencies": [
              "index_rate_percent_current",
              "margin_percent"
            ],
            "label": "Uncapped nominal annual rate (%)",
            "unit": "%",
            "format": "percent",
            "display": true
          },
          "capped_rate_percent": {
            "expression": "min(max(uncapped_rate_percent, floor_percent), initial_rate_percent + periodic_rate_cap_percent)",
            "dependencies": [
              "uncapped_rate_percent",
              "floor_percent",
              "initial_rate_percent",
              "periodic_rate_cap_percent"
            ],
            "label": "Rate after applying periodic cap/floor (%)",
            "unit": "%",
            "format": "percent",
            "display": true
          },
          "effective_apr_estimate_percent": {
            "expression": "( (initial_payment * payments_per_year / loan_amount) - 1 ) * 100",
            "dependencies": [
              "initial_payment",
              "payments_per_year",
              "loan_amount"
            ],
            "label": "Simple APR estimate (%)",
            "unit": "%",
            "format": "percent",
            "display": true
          }
        },
        "outputs": [
          {
            "id": "initial_payment",
            "label": "Initial scheduled payment",
            "variable": "initial_payment",
            "unit": "USD",
            "format": "currency"
          },
          {
            "id": "uncapped_rate_percent",
            "label": "Uncapped rate (annual %)",
            "variable": "uncapped_rate_percent",
            "unit": "%",
            "format": "percent"
          },
          {
            "id": "capped_rate_percent",
            "label": "Rate after cap/floor (annual %)",
            "variable": "capped_rate_percent",
            "unit": "%",
            "format": "percent"
          },
          {
            "id": "effective_apr_estimate_percent",
            "label": "Estimated APR (simple)",
            "variable": "effective_apr_estimate_percent",
            "unit": "%",
            "format": "percent"
          },
          {
            "id": "n_periods",
            "label": "Number of payments",
            "variable": "n_periods",
            "format": "integer"
          }
        ]
      },
      "fixed_rate_comparison": {
        "label": "Fixed-rate equivalent (compare payments)",
        "description": "Compute the amortizing payment if the initial rate remained fixed for the full term. Use this to compare variable initial payment vs fixed-rate alternative.",
        "variables": {
          "fixed_rate_decimal": {
            "expression": "initial_rate_percent / 100",
            "dependencies": [
              "initial_rate_percent"
            ],
            "label": "Fixed nominal annual rate (decimal)",
            "unit": "",
            "format": "decimal",
            "display": false
          },
          "fixed_periodic_rate": {
            "expression": "fixed_rate_decimal / payments_per_year",
            "dependencies": [
              "fixed_rate_decimal",
              "payments_per_year"
            ],
            "label": "Fixed periodic rate",
            "unit": "",
            "format": "decimal",
            "display": false
          },
          "fixed_n_periods": {
            "expression": "term_months * payments_per_year / 12",
            "dependencies": [
              "term_months",
              "payments_per_year"
            ],
            "label": "Total number of payments (fixed)",
            "unit": "",
            "format": "integer",
            "display": false
          },
          "fixed_factor": {
            "expression": "pow(1 + fixed_periodic_rate, fixed_n_periods)",
            "dependencies": [
              "fixed_periodic_rate",
              "fixed_n_periods"
            ],
            "label": "Fixed discount factor",
            "unit": "",
            "format": "decimal",
            "display": false
          },
          "fixed_payment": {
            "expression": "loan_amount * fixed_periodic_rate * fixed_factor / (fixed_factor - 1)",
            "dependencies": [
              "loan_amount",
              "fixed_periodic_rate",
              "fixed_factor"
            ],
            "label": "Fixed-rate payment per period",
            "unit": "USD",
            "format": "currency",
            "display": true
          },
          "payment_difference": {
            "expression": "initial_rate_percent > 0 ? fixed_payment - (loan_amount * ((index_rate_percent_current + margin_percent)/100) / payments_per_year * pow(1 + ((index_rate_percent_current + margin_percent)/100) / payments_per_year, term_months * payments_per_year / 12) / (pow(1 + ((index_rate_percent_current + margin_percent)/100) / payments_per_year, term_months * payments_per_year / 12) - 1)) : fixed_payment",
            "dependencies": [
              "fixed_payment",
              "loan_amount",
              "index_rate_percent_current",
              "margin_percent",
              "payments_per_year",
              "term_months"
            ],
            "label": "Fixed payment minus initial variable payment",
            "unit": "USD",
            "format": "currency",
            "display": true
          }
        },
        "outputs": [
          {
            "id": "fixed_payment",
            "label": "Fixed-rate payment (for comparison)",
            "variable": "fixed_payment",
            "unit": "USD",
            "format": "currency"
          },
          {
            "id": "payment_difference",
            "label": "Difference: fixed − initial variable",
            "variable": "payment_difference",
            "unit": "USD",
            "format": "currency"
          }
        ]
      }
    }
  },
  "form": {
    "fields": [
      {
        "id": "loan_amount",
        "label": "Loan amount",
        "type": "number",
        "default": 25000,
        "min": 1000,
        "max": 200000,
        "step": 100
      },
      {
        "id": "term_months",
        "label": "Loan term (months)",
        "type": "integer",
        "default": 60,
        "min": 6,
        "max": 84,
        "step": 1
      },
      {
        "id": "payments_per_year",
        "label": "Payments per year",
        "type": "integer",
        "default": 12,
        "min": 1,
        "max": 12,
        "step": 1,
        "options": [
          {
            "label": "Monthly (12)",
            "value": "12"
          }
        ]
      },
      {
        "id": "index_rate_percent_current",
        "label": "Current index rate (%)",
        "type": "number",
        "default": 3.0,
        "min": 0,
        "max": 20,
        "step": 0.01
      },
      {
        "id": "margin_percent",
        "label": "Lender margin (%)",
        "type": "number",
        "default": 2.0,
        "min": 0,
        "max": 10,
        "step": 0.01
      },
      {
        "id": "initial_rate_percent",
        "label": "Initial contract rate (%)",
        "type": "number",
        "default": 4.5,
        "min": 0,
        "max": 30,
        "step": 0.01
      },
      {
        "id": "rate_reset_frequency_months",
        "label": "Rate reset frequency (months)",
        "type": "integer",
        "default": 12,
        "min": 1,
        "max": 60,
        "step": 1
      },
      {
        "id": "periodic_rate_cap_percent",
        "label": "Periodic cap (%) (max change at reset)",
        "type": "number",
        "default": 2.0,
        "min": 0,
        "max": 10,
        "step": 0.01
      },
      {
        "id": "life_rate_cap_percent",
        "label": "Lifetime cap above initial rate (%)",
        "type": "number",
        "default": 5.0,
        "min": 0,
        "max": 20,
        "step": 0.01
      },
      {
        "id": "floor_percent",
        "label": "Rate floor (%)",
        "type": "number",
        "default": 0.0,
        "min": 0,
        "max": 30,
        "step": 0.01
      },
      {
        "id": "prepayment_rate_annual",
        "label": "Estimated annual prepayment rate (%)",
        "type": "number",
        "default": 0,
        "min": 0,
        "max": 100,
        "step": 0.1
      }
    ],
    "result": {
      "outputs": [
        {
          "id": "initial_payment",
          "label": "Initial scheduled payment"
        },
        {
          "id": "capped_rate_percent",
          "label": "Rate after cap/floor (annual %)"
        },
        {
          "id": "uncapped_rate_percent",
          "label": "Uncapped rate (annual %)"
        },
        {
          "id": "effective_apr_estimate_percent",
          "label": "Estimated APR (simple %)"
        },
        {
          "id": "fixed_payment",
          "label": "Fixed-rate payment (comparison)"
        },
        {
          "id": "payment_difference",
          "label": "Difference: fixed − initial variable"
        },
        {
          "id": "n_periods",
          "label": "Number of payments"
        }
      ]
    }
  },
  "page_content": {
    "introduction": [
      "This estimator helps you understand the initial scheduled payment and key rate metrics for adjustable-rate auto loans where the interest is defined as an index plus a lender margin. It also provides a fixed-rate comparison to help you judge payment stability versus potential savings.",
      "The tool is intended for planning and comparison only. It models a standard fully amortizing schedule using the current index plus margin for the next reset period and applies simple cap/floor rules; it does not simulate an entire stochastic index path or lender-specific adjustment rules."
    ],
    "methodology": [
      "Calculations use standard amortization formulas to compute periodic payments from a periodic interest rate and number of payments. For variable-rate scenarios the estimator computes the initial scheduled payment from the current index plus margin, then applies simple periodic and lifetime caps and a floor to derive the rate used for display and comparison.",
      "Accuracy, input validation, and numerical stability follow recognized engineering and quality practices. Numerical routines assume double-precision arithmetic per IEEE 754 recommendations for floating-point arithmetic. Security of stored or transmitted inputs and results should follow NIST guidance on data handling and system integrity. This estimator is not a legal disclosure and should be cross-checked against a lender-provided amortization schedule and regulatory disclosures."
    ],
    "how_is_calculated": [
      "Convert annual nominal rates to a decimal: rate_decimal = (index + margin) / 100.",
      "Convert to periodic rate: periodic_rate = rate_decimal / payments_per_year.",
      "Compute total number of payments: n_periods = term_months * payments_per_year / 12.",
      "Periodic payment (amortizing): payment = loan_amount * periodic_rate * (1+periodic_rate)^n / ((1+periodic_rate)^n - 1).",
      "Apply caps/floors to present a capped initial rate: capped_rate = min(max(uncapped_rate, floor), initial_rate + periodic_cap)."
    ],
    "faqs": [
      {
        "question": "Is this estimator the same as the lender's disclosure?",
        "answer": "No. This estimator provides a calculation based on the inputs you supply and standard amortization formulas. Lenders must follow contract terms and regulatory disclosure methodologies that may include fees, compounding specifics, or differing index conventions. Always review the lender-provided Truth-in-Lending disclosure for exact amounts."
      },
      {
        "question": "Does the tool simulate future index movements?",
        "answer": "No. It uses the current index value you enter and applies simple cap/floor rules. It does not model or forecast index changes or produce probabilistic outcomes. For scenario analysis, manually adjust the index value and re-run to compare outcomes."
      },
      {
        "question": "How precise are the results?",
        "answer": "Results use standard amortization formulas and assume floating-point arithmetic. Small rounding differences can occur depending on the lender's rounding rules and compounding conventions. For compliance-grade figures, use the lender's amortization schedule and disclosures."
      },
      {
        "question": "What limits or calibration should I be aware of?",
        "answer": "This estimator enforces sensible input ranges but does not validate contract language. It does not include lender fees, insurance, taxes, or negative amortization features. Use it for comparison and planning; consult a loan contract or financial professional for binding estimates."
      }
    ],
    "citations": [
      {
        "label": "NIST — Computer Security and Data Integrity guidance",
        "url": "https://www.nist.gov"
      },
      {
        "label": "ISO — Standards for quality management and numerical methods",
        "url": "https://www.iso.org"
      },
      {
        "label": "IEEE — Floating-point arithmetic recommendations (IEEE 754)",
        "url": "https://www.ieee.org"
      },
      {
        "label": "OSHA — Workplace safety and risk-management references",
        "url": "https://www.osha.gov"
      }
    ],
    "glossary": [
      {
        "term": "Index",
        "definition": "A market reference rate (for example, a published short-term rate) that is used to set the variable portion of the loan interest rate."
      },
      {
        "term": "Margin",
        "definition": "A fixed percentage the lender adds to the index to determine the loan's nominal interest rate."
      },
      {
        "term": "Periodic cap",
        "definition": "The maximum allowed change in the nominal rate at a single reset period, expressed as a percentage point limit."
      },
      {
        "term": "Lifetime cap",
        "definition": "The maximum allowed increase in the nominal rate over the initial contract rate for the life of the loan."
      },
      {
        "term": "Floor",
        "definition": "Minimum allowable nominal interest rate for the loan, expressed as a percentage."
      },
      {
        "term": "APR (estimated)",
        "definition": "A simplified, approximate measure of annualized cost derived from periodic payments used here for rough comparison; not a regulatory Truth-in-Lending APR."
      }
    ]
  },
  "links": {
    "internal": [],
    "external": [
      {
        "url": "https://www.nist.gov",
        "label": "NIST",
        "rel": [
          "noopener",
          "noreferrer"
        ]
      },
      {
        "url": "https://www.iso.org",
        "label": "ISO",
        "rel": [
          "noopener",
          "noreferrer"
        ]
      },
      {
        "url": "https://www.ieee.org",
        "label": "IEEE",
        "rel": [
          "noopener",
          "noreferrer"
        ]
      },
      {
        "url": "https://www.osha.gov",
        "label": "OSHA",
        "rel": [
          "noopener",
          "noreferrer"
        ]
      }
    ]
  },
  "schema": {
    "additionalTypes": [
      "HowTo"
    ]
  }
}