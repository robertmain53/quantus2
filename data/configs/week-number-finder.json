{
  "version": "1.0.0",
  "metadata": {
    "title": "Week Number Finder (ISO / US / Custom)",
    "description": "Calculate the week number for any Gregorian calendar date using multiple conventions (ISO‑8601, US Sunday start, simple Jan 1 start, or a custom start day). Includes explanatory methodology, accuracy notes, and standards citations."
  },
  "logic": {
    "type": "advanced",
    "defaultMethod": "iso_8601",
    "methods": {
      "iso_8601": {
        "label": "ISO 8601 (Monday start, week 1 has the year's first Thursday)",
        "description": "Calculates the ISO week number based on the ISO 8601 rule where weeks start on Monday and week 1 is the week containing January 4 (equivalently, the week with the year's first Thursday). This method returns the week number as an integer; in boundary cases the associated ISO week-year may differ from the calendar year.",
        "variables": {
          "a": {
            "expression": "floor((14 - month) / 12)",
            "dependencies": [
              "month"
            ],
            "label": "Gregorian adjustment a",
            "display": false
          },
          "y": {
            "expression": "year + 4800 - a",
            "dependencies": [
              "year",
              "a"
            ],
            "label": "Adjusted year y",
            "display": false
          },
          "m": {
            "expression": "month + 12 * a - 3",
            "dependencies": [
              "month",
              "a"
            ],
            "label": "Adjusted month m",
            "display": false
          },
          "jdn": {
            "expression": "day + floor((153 * m + 2) / 5) + 365 * y + floor(y / 4) - floor(y / 100) + floor(y / 400) - 32045",
            "dependencies": [
              "day",
              "m",
              "y"
            ],
            "label": "Julian Day Number (JDN) for date",
            "display": false
          },
          "weekday_iso": {
            "expression": "((jdn + 1) % 7) + 1",
            "dependencies": [
              "jdn"
            ],
            "label": "ISO weekday (1=Monday..7=Sunday)",
            "display": false
          },
          "a1": {
            "expression": "floor((14 - 1) / 12)",
            "dependencies": [],
            "label": "Adjustment for Jan 1",
            "display": false
          },
          "y1": {
            "expression": "year + 4800 - a1",
            "dependencies": [
              "year",
              "a1"
            ],
            "label": "Adjusted year for Jan 1",
            "display": false
          },
          "m1": {
            "expression": "1 + 12 * a1 - 3",
            "dependencies": [
              "a1"
            ],
            "label": "Adjusted month for Jan 1",
            "display": false
          },
          "jdn_jan1": {
            "expression": "1 + floor((153 * m1 + 2) / 5) + 365 * y1 + floor(y1 / 4) - floor(y1 / 100) + floor(y1 / 400) - 32045",
            "dependencies": [
              "m1",
              "y1"
            ],
            "label": "JDN of Jan 1 of calendar year",
            "display": false
          },
          "day_of_year": {
            "expression": "jdn - jdn_jan1 + 1",
            "dependencies": [
              "jdn",
              "jdn_jan1"
            ],
            "label": "Day of year (1..365/366)",
            "display": false
          },
          "iso_week_number_raw": {
            "expression": "floor((day_of_year - weekday_iso + 10) / 7)",
            "dependencies": [
              "day_of_year",
              "weekday_iso"
            ],
            "label": "Raw ISO week number",
            "display": true,
            "format": "integer"
          }
        },
        "outputs": [
          {
            "id": "week_number",
            "label": "ISO week number",
            "variable": "iso_week_number_raw",
            "format": "integer"
          },
          {
            "id": "week_year",
            "label": "ISO week-year (may differ from calendar year)",
            "variable": "year",
            "format": "integer",
            "unit": "year"
          }
        ]
      },
      "us_sunday": {
        "label": "US-style (weeks start Sunday, week 1 contains Jan 1)",
        "description": "Weeks begin on Sunday. Week numbering starts with the week that contains January 1 as week 1. This is a simple civil convention commonly used for scheduling in the United States.",
        "variables": {
          "a": {
            "expression": "floor((14 - month) / 12)",
            "dependencies": [
              "month"
            ],
            "label": "Gregorian adjustment a",
            "display": false
          },
          "y": {
            "expression": "year + 4800 - a",
            "dependencies": [
              "year",
              "a"
            ],
            "label": "Adjusted year y",
            "display": false
          },
          "m": {
            "expression": "month + 12 * a - 3",
            "dependencies": [
              "month",
              "a"
            ],
            "label": "Adjusted month m",
            "display": false
          },
          "jdn": {
            "expression": "day + floor((153 * m + 2) / 5) + 365 * y + floor(y / 4) - floor(y / 100) + floor(y / 400) - 32045",
            "dependencies": [
              "day",
              "m",
              "y"
            ],
            "label": "JDN for date",
            "display": false
          },
          "weekday_sun": {
            "expression": "(jdn + 1) % 7",
            "dependencies": [
              "jdn"
            ],
            "label": "Weekday with Sunday=0",
            "display": false
          },
          "a1": {
            "expression": "floor((14 - 1) / 12)",
            "dependencies": [],
            "label": "Adjustment for Jan 1",
            "display": false
          },
          "y1": {
            "expression": "year + 4800 - a1",
            "dependencies": [
              "year",
              "a1"
            ],
            "label": "Adjusted year for Jan 1",
            "display": false
          },
          "m1": {
            "expression": "1 + 12 * a1 - 3",
            "dependencies": [
              "a1"
            ],
            "label": "Adjusted month for Jan 1",
            "display": false
          },
          "jdn_jan1": {
            "expression": "1 + floor((153 * m1 + 2) / 5) + 365 * y1 + floor(y1 / 4) - floor(y1 / 100) + floor(y1 / 400) - 32045",
            "dependencies": [
              "m1",
              "y1"
            ],
            "label": "JDN of Jan 1",
            "display": false
          },
          "day_of_year": {
            "expression": "jdn - jdn_jan1 + 1",
            "dependencies": [
              "jdn",
              "jdn_jan1"
            ],
            "label": "Day of year",
            "display": false
          },
          "us_week_number": {
            "expression": "floor((day_of_year + weekday_sun) / 7) + 1",
            "dependencies": [
              "day_of_year",
              "weekday_sun"
            ],
            "label": "US-style week number",
            "display": true,
            "format": "integer"
          }
        },
        "outputs": [
          {
            "id": "week_number",
            "label": "US-style week number",
            "variable": "us_week_number",
            "format": "integer"
          },
          {
            "id": "week_year",
            "label": "Calendar year for week number",
            "variable": "year",
            "format": "integer",
            "unit": "year"
          }
        ]
      },
      "simple_jan1": {
        "label": "Simple (week 1 starts Jan 1)",
        "description": "A straightforward convention that divides the year into sequential 7-day blocks starting at January 1. Week 1 is days 1–7, week 2 is days 8–14, etc. This is the simplest civil mapping and does not align with ISO rules for partial-week boundaries.",
        "variables": {
          "a": {
            "expression": "floor((14 - month) / 12)",
            "dependencies": [
              "month"
            ],
            "label": "Gregorian adjustment",
            "display": false
          },
          "y": {
            "expression": "year + 4800 - a",
            "dependencies": [
              "year",
              "a"
            ],
            "label": "Adjusted year",
            "display": false
          },
          "m": {
            "expression": "month + 12 * a - 3",
            "dependencies": [
              "month",
              "a"
            ],
            "label": "Adjusted month",
            "display": false
          },
          "jdn": {
            "expression": "day + floor((153 * m + 2) / 5) + 365 * y + floor(y / 4) - floor(y / 100) + floor(y / 400) - 32045",
            "dependencies": [
              "day",
              "m",
              "y"
            ],
            "label": "JDN",
            "display": false
          },
          "a1": {
            "expression": "floor((14 - 1) / 12)",
            "dependencies": [],
            "label": "Adjustment for Jan 1",
            "display": false
          },
          "y1": {
            "expression": "year + 4800 - a1",
            "dependencies": [
              "year",
              "a1"
            ],
            "label": "Adjusted year for Jan 1",
            "display": false
          },
          "m1": {
            "expression": "1 + 12 * a1 - 3",
            "dependencies": [
              "a1"
            ],
            "label": "Adjusted month for Jan 1",
            "display": false
          },
          "jdn_jan1": {
            "expression": "1 + floor((153 * m1 + 2) / 5) + 365 * y1 + floor(y1 / 4) - floor(y1 / 100) + floor(y1 / 400) - 32045",
            "dependencies": [
              "m1",
              "y1"
            ],
            "label": "JDN Jan 1",
            "display": false
          },
          "day_of_year": {
            "expression": "jdn - jdn_jan1 + 1",
            "dependencies": [
              "jdn",
              "jdn_jan1"
            ],
            "label": "Day of year",
            "display": false
          },
          "simple_week_number": {
            "expression": "ceil(day_of_year / 7)",
            "dependencies": [
              "day_of_year"
            ],
            "label": "Simple week number",
            "display": true,
            "format": "integer"
          }
        },
        "outputs": [
          {
            "id": "week_number",
            "label": "Simple week number",
            "variable": "simple_week_number",
            "format": "integer"
          },
          {
            "id": "week_year",
            "label": "Calendar year for week number",
            "variable": "year",
            "format": "integer",
            "unit": "year"
          }
        ]
      },
      "custom": {
        "label": "Custom start day & rule",
        "description": "Allows a custom choice of the weekday that begins a week and a selection of the 'first week' rule. Use this when your organization uses a nonstandard week definition.",
        "variables": {
          "a": {
            "expression": "floor((14 - month) / 12)",
            "dependencies": [
              "month"
            ],
            "label": "Gregorian adjustment",
            "display": false
          },
          "y": {
            "expression": "year + 4800 - a",
            "dependencies": [
              "year",
              "a"
            ],
            "label": "Adjusted year",
            "display": false
          },
          "m": {
            "expression": "month + 12 * a - 3",
            "dependencies": [
              "month",
              "a"
            ],
            "label": "Adjusted month",
            "display": false
          },
          "jdn": {
            "expression": "day + floor((153 * m + 2) / 5) + 365 * y + floor(y / 4) - floor(y / 100) + floor(y / 400) - 32045",
            "dependencies": [
              "day",
              "m",
              "y"
            ],
            "label": "JDN",
            "display": false
          },
          "weekday_0_6": {
            "expression": "(jdn + 1) % 7",
            "dependencies": [
              "jdn"
            ],
            "label": "Weekday as 0..6 (Sunday=0)",
            "display": false
          },
          "week_start_index": {
            "expression": "switch(week_start, 'Sunday', 0, 'Monday', 1, 'Tuesday', 2, 'Wednesday', 3, 'Thursday', 4, 'Friday', 5, 'Saturday', 6, 1)",
            "dependencies": [
              "week_start"
            ],
            "label": "Index of selected week start (0=Sunday)",
            "display": false
          },
          "offset_to_week_start": {
            "expression": "(weekday_0_6 - week_start_index + 7) % 7",
            "dependencies": [
              "weekday_0_6",
              "week_start_index"
            ],
            "label": "Days since the most recent week start",
            "display": false
          },
          "a1": {
            "expression": "floor((14 - 1) / 12)",
            "dependencies": [],
            "label": "Adjustment for Jan 1",
            "display": false
          },
          "y1": {
            "expression": "year + 4800 - a1",
            "dependencies": [
              "year",
              "a1"
            ],
            "label": "Adjusted year for Jan 1",
            "display": false
          },
          "m1": {
            "expression": "1 + 12 * a1 - 3",
            "dependencies": [
              "a1"
            ],
            "label": "Adjusted month for Jan 1",
            "display": false
          },
          "jdn_jan1": {
            "expression": "1 + floor((153 * m1 + 2) / 5) + 365 * y1 + floor(y1 / 4) - floor(y1 / 100) + floor(y1 / 400) - 32045",
            "dependencies": [
              "m1",
              "y1"
            ],
            "label": "JDN Jan 1",
            "display": false
          },
          "day_of_year": {
            "expression": "jdn - jdn_jan1 + 1",
            "dependencies": [
              "jdn",
              "jdn_jan1"
            ],
            "label": "Day of year",
            "display": false
          },
          "adjusted_day_index": {
            "expression": "day_of_year + (week_start_index - ((jdn_jan1 + 1) % 7) + 7) % 7",
            "dependencies": [
              "day_of_year",
              "week_start_index",
              "jdn_jan1"
            ],
            "label": "Day index adjusted so first week starts per selected rule",
            "display": false
          },
          "custom_week_number": {
            "expression": "ceil(adjusted_day_index / 7)",
            "dependencies": [
              "adjusted_day_index"
            ],
            "label": "Custom week number",
            "display": true,
            "format": "integer"
          }
        },
        "outputs": [
          {
            "id": "week_number",
            "label": "Custom week number",
            "variable": "custom_week_number",
            "format": "integer"
          },
          {
            "id": "week_year",
            "label": "Associated calendar year",
            "variable": "year",
            "format": "integer",
            "unit": "year"
          }
        ]
      }
    }
  },
  "form": {
    "fields": [
      {
        "id": "year",
        "label": "Year (Gregorian)",
        "type": "integer",
        "default": 2025,
        "min": 1,
        "max": 9999,
        "step": 1
      },
      {
        "id": "month",
        "label": "Month",
        "type": "integer",
        "default": 12,
        "min": 1,
        "max": 12,
        "step": 1
      },
      {
        "id": "day",
        "label": "Day",
        "type": "integer",
        "default": 2,
        "min": 1,
        "max": 31,
        "step": 1
      },
      {
        "id": "week_start",
        "label": "Week starts on",
        "type": "select",
        "default": "Monday",
        "options": [
          {
            "label": "Sunday",
            "value": "Sunday"
          },
          {
            "label": "Monday",
            "value": "Monday"
          },
          {
            "label": "Tuesday",
            "value": "Tuesday"
          },
          {
            "label": "Wednesday",
            "value": "Wednesday"
          },
          {
            "label": "Thursday",
            "value": "Thursday"
          },
          {
            "label": "Friday",
            "value": "Friday"
          },
          {
            "label": "Saturday",
            "value": "Saturday"
          }
        ]
      },
      {
        "id": "first_week_rule",
        "label": "First-week rule",
        "type": "select",
        "default": "ISO_8601",
        "options": [
          {
            "label": "ISO 8601 (week with Jan 4)",
            "value": "ISO_8601"
          },
          {
            "label": "Week containing Jan 1",
            "value": "Jan1"
          },
          {
            "label": "First full week",
            "value": "FirstFullWeek"
          }
        ]
      }
    ]
  },
  "page_content": {
    "introduction": [
      "This Week Number Finder computes the week number for a given Gregorian calendar date using multiple conventions: ISO 8601, a US-style Sunday-start rule, a simple Jan 1 start, or a fully custom week-start definition. Choose the method that matches your scheduling, reporting, or regulatory needs.",
      "Results include the numeric week and the associated calendar year for that week. The tool includes clear notes on boundary cases (weeks that cross calendar years), leap-year handling, and the authoritative standards used to define week-counting rules."
    ],
    "methodology": [
      "ISO 8601 is the international standard for week numbering: weeks start on Monday and week 1 is the week containing January 4 of the calendar year. This tool implements an established algorithm that converts the input date to a Julian Day Number (JDN), derives weekday and day-of-year, then applies the ISO formula to compute the week number.",
      "The US-style method treats Sunday as the first day of the week and designates the week containing January 1 as week 1. The simple Jan 1 method divides the year into consecutive 7-day blocks beginning on January 1. The custom method shifts the start-of-week and first-week alignment per user selection.",
      "All calculations use proleptic Gregorian rules (Gregorian leap-year rules applied for all years) and integer arithmetic to avoid rounding issues. Boundary cases (for example, ISO week 1 that begins in the previous calendar year) are handled according to the chosen method; see the FAQ for specifics."
    ],
    "how_is_calculated": [
      "Convert the input Gregorian date (year, month, day) to a Julian Day Number (JDN) using the standard astronomical formula. JDN is robust for day arithmetic across months and leap years.",
      "Derive day-of-year and weekday from the JDN. Weekday indexing follows the convention needed by the method: ISO uses Monday=1..Sunday=7; US-style uses Sunday=0..Saturday=6.",
      "Apply the method-specific week formula: ISO uses floor((dayOfYear - weekday + 10)/7); simple Jan 1 uses ceil(dayOfYear/7); custom methods adjust the day index to the chosen week start and then bucket into 7-day blocks."
    ],
    "faqs": [
      {
        "question": "Which week-numbering standard should I use for legal or reporting purposes?",
        "answer": "Use ISO 8601 for international reporting and many government or business standards. Some local or legacy systems use a US-style Sunday-start rule or simple Jan 1 counting. Confirm the requirement in your regulatory or contractual documentation before choosing a method."
      },
      {
        "question": "How are leap years and Feb 29 handled?",
        "answer": "This tool uses Gregorian leap-year rules (year divisible by 4, except centuries not divisible by 400). Day-of-year and JDN calculations account for Feb 29 automatically. The week-numbering method then assigns that date to the appropriate week."
      },
      {
        "question": "What about dates that fall in the first or last week and belong to a different week-year?",
        "answer": "ISO weeks occasionally assign early-January dates to the last ISO week of the previous ISO week-year, or late-December dates to week 1 of the next ISO week-year. The ISO method output includes the associated week-year. For simple methods, the week-year equals the calendar year."
      },
      {
        "question": "How accurate are these calculations and what are the limits?",
        "answer": "Calculations follow standard arithmetic and Gregorian calendar rules and are accurate for years in the range 1..9999. Edge cases depend on the chosen convention; users should validate critical schedules against authoritative sources. This tool is intended for civil calendaring only and not for astronomical or legal timekeeping that requires time-zone or leap-second accounting."
      },
      {
        "question": "Can I automate batch processing with this algorithm?",
        "answer": "Yes. The method is deterministic and can be implemented server-side in bulk. When automating, ensure you document which week-number convention is used and include a test set covering boundary dates (e.g., Jan 1–7 and Dec 25–31) to validate behavior."
      }
    ],
    "citations": [
      {
        "label": "ISO 8601: Date and time format (week date)",
        "url": "https://www.iso.org/iso-8601-date-and-time-format.html"
      },
      {
        "label": "NIST: Time and Frequency Division (time standards)",
        "url": "https://www.nist.gov/pml/time-and-frequency-domain"
      },
      {
        "label": "IEEE 1588 (Precision Time Protocol) – relevance for high-precision timekeeping",
        "url": "https://standards.ieee.org/standard/1588-2019.html"
      },
      {
        "label": "OSHA: Recordkeeping guidance for workplace timekeeping (context for scheduling and compliance)",
        "url": "https://www.osha.gov/recordkeeping"
      }
    ],
    "glossary": [
      {
        "term": "ISO week",
        "definition": "A week defined under ISO 8601: weeks start on Monday and week 1 contains the year's first Thursday (equivalently January 4)."
      },
      {
        "term": "Julian Day Number (JDN)",
        "definition": "A continuous count of days used in astronomy; converting a Gregorian date to JDN simplifies day arithmetic across months and years."
      },
      {
        "term": "Day of year",
        "definition": "Ordinal day within a year, starting with 1 for January 1 up to 365 or 366 in a leap year."
      },
      {
        "term": "Week-year",
        "definition": "The year number that a week is considered part of under a week-numbering convention; for ISO this can differ from the calendar year for dates near year boundaries."
      }
    ],
    "summary": [
      "Select the method that matches your reporting or scheduling needs: ISO 8601 for international consistency, US-style for Sunday-based calendars, simple Jan 1 for the simplest partitioning, or Custom to match an organizational convention.",
      "All computations use standard Gregorian calendar arithmetic and JDN conversions. Review boundary-case behavior before using results in compliance-sensitive contexts."
    ]
  },
  "schema": {
    "additionalTypes": [
      "HowTo"
    ]
  }
}